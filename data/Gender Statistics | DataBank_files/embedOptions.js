function chooseEmbedFrameSize(){$(".btnEmbedSize").click(function(){var n=$(this).attr("embed-size"),t,i;n=n.split("X");t=n[0];i=n[1];$("#chartWrapper").attr("width",t);$("#chartWrapper").attr("height",i);$("#inputEmbedWidth").val(t);$("#inputEmbedHeight").val(i);showembedloading();$("#chartWrapper").attr("src","");$("#chartWrapper").attr("src",gbl_embedsource_src);generateCode()});$("#inputEmbedWidth").blur(function(){var n=$(this).val();$("#chartWrapper").attr("width",n);n<=500&&($(".btnEmbedSize").removeClass("active"),$("#embedSmallSize").addClass("active"));n>500&&n<=750&&($(".btnEmbedSize").removeClass("active"),$("#embedMediumSize").addClass("active"));n>750&&($(".btnEmbedSize").removeClass("active"),$("#embedLargeSize").addClass("active"));showembedloading();$("#chartWrapper").attr("src","");$("#chartWrapper").attr("src",gbl_embedsource_src);generateCode()});$("#inputEmbedHeight").blur(function(){var t=$(this).val(),n=$("#inputEmbedWidth").val();$("#chartWrapper").attr("height",t-50);n<=500&&($(".btnEmbedSize").removeClass("active"),$("#embedSmallSize").addClass("active"));n>500&&n<=750&&($(".btnEmbedSize").removeClass("active"),$("#embedMediumSize").addClass("active"));n>750&&($(".btnEmbedSize").removeClass("active"),$("#embedLargeSize").addClass("active"));showembedloading();$("#chartWrapper").attr("src","");$("#chartWrapper").attr("src",gbl_embedsource_src)})}function showembedloading(){var n=$("#chartWrapper").contents().find("body"),t=parseInt(n.height()/2);n.html($("#report-loading")[0].outerHTML);n.find("#report-loading").css("top",t+"px").css("width","90%").css("text-align","center").css("position","absolute").show();setTimeout(function(){n.find("#report-loading img").attr("src",gbl_basepath+"images/ajax-loader.gif")},200)}function showHideEntities(){$("#chkDimensionDpDwn").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find("#REPORT_PREVIEW_divdropdown").show():$("#chartWrapper").contents().find("#REPORT_PREVIEW_divdropdown").hide();generateCode()});$("#chkMetadataDimensionDpDwn").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find(".metadata-tools").show():$("#chartWrapper").contents().find(".metadata-tools").hide();$(this).is(":checked")?$("#chartWrapper").contents().find(".columnContent").css("top","70px"):$("#chartWrapper").contents().find(".columnContent").css("top","40px");generateCode()});$("#chkLinkBar").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find("#embedLinks").fadeIn("fast",function(){$(".secondary").removeAttr("disabled");$("#availableThemes").show();$(".secondary").prop("checked",!0);$("#embedLinkList li a").show()}):$("#chartWrapper").contents().find("#embedLinks").fadeOut("fast",function(){$(".secondary").attr("disabled",!0);$("#availableThemes").hide();$(".secondary").prop("checked",!0);$(".tertiary").prop("disabled",!0)});generateCode()});$("#chkShareLink").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find("#shareLink").show():$("#chartWrapper").contents().find("#shareLink").hide();generateCode()});$("#chkDownloadLink").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find("#downloadLink").show("fast",function(){$(".tertiary").prop("checked",!0);$(".tertiary").prop("disabled",!1);generateCode()}):$("#chartWrapper").contents().find("#downloadLink").hide("fast",function(){$(".tertiary").prop("disabled",!0);generateCode()})});$("#chkPrintLink").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find("#printLink").show():$("#chartWrapper").contents().find("#printLink").hide();generateCode()});$("#chkNavigator").on("click",function(){showembedloading();generateCode();$("#chartWrapper").attr("src","");$("#chartWrapper").attr("src",gbl_embedsource_src)});$("#chkEmbedShowZoombar").on("click",function(){$(this).is(":checked")?($("#chartWrapper").contents().find("#map_zoom_slider").show(),$("#chartWrapper").contents().find("#hdnShowZoombar").val("1")):($("#chartWrapper").contents().find("#map_zoom_slider").hide(),$("#chartWrapper").contents().find("#hdnShowZoombar").val("0"));generateCode()});$("#chkEmbedShowLegend").on("click",function(){$(this).is(":checked")?($("#chartWrapper").contents().find("#legend").show(),$("#chartWrapper").contents().find("#hdnShowLegend").val("1")):($("#chartWrapper").contents().find("#legend").hide(),$("#chartWrapper").contents().find("#hdnShowLegend").val("0"));generateCode()});$("#chkInfoLink").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find("#infoLink").show():$("#chartWrapper").contents().find("#infoLink").hide();generateCode()});$("#chkExcel").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find(".downloadExcel").show():$("#chartWrapper").contents().find(".downloadExcel ").hide();generateCode()});$("#chkCSV").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find(".downloadCSV").show():$("#chartWrapper").contents().find(".downloadCSV").hide();generateCode()});$("#chkTabbedTxt").on("click",function(){$(this).is(":checked")?$("#chartWrapper").contents().find(".downloadTAB").show():$("#chartWrapper").contents().find(".downloadTAB").hide();generateCode()});if($("#chkOmnitureSuite").length>0)$("#chkOmnitureSuite").on("click",function(){generateCode()});$("#selDescFontStyle").change(function(){var n=$(this).val();n=="bold"&&$("#chartWrapper").contents().find("#widgetDesc").css({"font-weight":"bold","font-style":"normal"});n=="bold italic"&&$("#chartWrapper").contents().find("#widgetDesc").css({"font-weight":"bold","font-style":"italic"});n=="italic"&&$("#chartWrapper").contents().find("#widgetDesc").css({"font-weight":"normal","font-style":"italic"});n=="normal"&&$("#chartWrapper").contents().find("#widgetDesc").css({"font-style":"normal","font-weight":"normal"});generateCode()});$("#radioBtnShowDesc").click(function(){$("#chartWrapper").contents().find("#widgetDesc").show();generateCode()});$("#selDescFont").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetDesc").css({"font-family":n});generateCode()});$("#selDescFontSize").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetDesc").css({"font-size":n});generateCode()});$("#selDescAlignment").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetDesc").css({"text-align":n});generateCode()});$("#selTitleFontStyle").change(function(){var n=$(this).val();n=="bold"&&$("#chartWrapper").contents().find("#widgetTitle").css({"font-weight":"bold","font-style":"normal"});n=="bold italic"&&$("#chartWrapper").contents().find("#widgetTitle").css({"font-weight":"bold","font-style":"italic"});n=="italic"&&$("#chartWrapper").contents().find("#widgetTitle").css({"font-weight":"normal","font-style":"italic"});n=="normal"&&$("#chartWrapper").contents().find("#widgetTitle").css({"font-style":"normal","font-weight":"normal"});generateCode()});$("#radioBtnShowTitle").click(function(){$("#chartWrapper").contents().find("#widgetTitle").show();generateCode()});$("#radioBtnHideTitle").click(function(){$("#chartWrapper").contents().find("#widgetTitle").hide();generateCode()});$("#radioBtnShowDesc").click(function(){$("#chartWrapper").contents().find("#widgetDesc").show();generateCode()});$("#radioBtnHideDesc").click(function(){$("#chartWrapper").contents().find("#widgetDesc").hide();generateCode()});$("#selTitleFont").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetTitle").css({"font-family":n});generateCode()});$("#selTitleFontSize").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetTitle").css({"font-size":n});generateCode()});$("#selTitleAlignment").change(function(){var n=$(this).val();$("#chartWrapper").contents().find("#widgetTitle").css({"text-align":n});generateCode()});$("#borderWidth").change(function(){$(this).find(":selected").val()!="None"&&($("#chartWrapper").contents().find("#widgetpreview").css("border-width",$(this).find(":selected").val().split("px")[0]+"px"),$("#borderStyle,#canvasBorder").show());generateCode()});$("#borderStyle").change(function(){$("#chartWrapper").contents().find("#widgetpreview").css("border-style",$(this).find(":selected").val());generateCode()});$("#txtTitle").keyup(function(){$("#widgetTitle",getFrame().documentElement).html($("#txtTitle").val())});$("#txtDesc").keyup(function(){$("#widgetDesc",getFrame().documentElement).html($("#txtDesc").val())});$("#radioBtnShowTitle, #radioBtnShowDesc").on("click",function(){$("#txtTitle").val()==""&&$("#txtTitle").val($("#widgetTitle",getFrame().documentElement).html());$("#txtDesc").val()==""&&$("#txtDesc").val($("#widgetDesc",getFrame().documentElement).html())});$(".applyChangesEmbed").on("click",function(){var n=$("#hdnReportID").val();if(n==""||parseInt(n)<=0){alert("Please save the report before apply changes.");return}$.ajax({type:"POST",url:gbl_report_methods+"/SaveTitleDescReports",contentType:"application/json; charset=utf-8",data:"{reportid: "+n+', title:"'+$("#txtTitle").val()+'", description:"'+$("#txtDesc").val()+'"}',dataType:"json",success:function(n){n.d!=""&&alert("Failed to save Title and Descrption")},error:function(){$("#report-loading").fadeOut(500);window.location.href="../../ddperror.aspx"}})})}function getFrame(){var n=document.getElementById("chartWrapper");return n.contentDocument||n.contentWindow.document}function initAvailableThemeSel(){$(".availableThemeList li").on("click",function(){var n=$(this).attr("id");$(".availableThemeList li").removeClass("active");$(this).addClass("active");$("#chartWrapper").contents().find("#embedLinkList li").attr("class","");$("#chartWrapper").contents().find("#embedLinkList li").addClass(n);$("#chartWrapper").contents().find("#infoLinkDesc").attr("class","");$("#chartWrapper").contents().find("#downloadLinkDesc").attr("class","");$("#chartWrapper").contents().find("#shareLinkDesc").attr("class","");$("#chartWrapper").contents().find("#infoLinkDesc").addClass("embedLinkDesc");$("#chartWrapper").contents().find("#downloadLinkDesc").addClass("embedLinkDesc");$("#chartWrapper").contents().find("#shareLinkDesc").addClass("embedLinkDesc");$("#chartWrapper").contents().find("#infoLinkDesc").addClass(n);$("#chartWrapper").contents().find("#downloadLinkDesc").addClass(n);$("#chartWrapper").contents().find("#shareLinkDesc").addClass(n);generateCode()})}function generateEmbedForMap(n,t){gbl_map_zoomdata=n;gbl_map_extentdata=t;generateCode()}function generateCode(){var r,u,nt,f,e,tt,it,o,rt;$(".embed").val("");var s,h,v,y,p,w,b,k,d,ut,ft,et,n,g,t="",ot=$(".availableThemeList li.active").attr("id"),c=$("#canvasBorder")[0].color==null?"rgb(255,255,255)":$("#canvasBorder")[0].color.active.val("rgb"),st=$("#borderStyle").val(),ht=$("#borderWidth").val();s=$("#radioBtnShowTitle").hasClass("active")?"y":"n";h=$("#radioBtnShowDesc").hasClass("active")?"y":"n";v=$("#chkDimensionDpDwn").is(":checked")?"y":"n";md=$("#chkMetadataDimensionDpDwn").is(":checked")?"y":"n";y=$("#chkLinkBar").is(":checked")?"y":"n";p=$("#chkShareLink").is(":checked")?"y":"n";w=$("#chkDownloadLink").is(":checked")?"y":"n";b=$("#chkPrintLink").is(":checked")?"y":"n";g=$("#chkNavigator").is(":checked")?"y":"n";k=$("#chkInfoLink").is(":checked")?"y":"n";$("#chkOmnitureSuite").length>0&&(n=$("#chkOmnitureSuite").is(":checked")?"y":"n");d="y";var ct=$("#inputEmbedWidth").val(),lt=$("#inputEmbedHeight").val(),l=$("#selTitleFontColor")[0].color==null?"rgb(255,255,255)":$("#selTitleFontColor")[0].color.active.val("rgb"),a=$("#selDescColor")[0].color==null?"rgb(255,255,255)":$("#selDescColor")[0].color.active.val("rgb"),i="";if($(".downloadopt").each(function(){this.checked&&(i!=""&&(i+=","),i+=this.id.replace("chk",""))}),toSaveOptions="ti="+s+"&ds="+h+"&dd="+v+"&tb="+y+"&sh="+p+"&dw="+w+"&pr="+b+"&inf="+k+"&zm="+d+"&md="+md,$("#chkXAxis").length>0&&(toSaveOptions+="&xlbl="+ut+"&ylbl="+ft+"&legend="+et),toSaveOptions+="&navigator="+g+"&theme="+ot+"&bdrClr=rgb("+c.r+","+c.g+","+c.b+")&bdrStyle="+st+"&bdrWidth="+ht,s=="y"){nt=$("#selTitleFontStyle").val();switch(nt){case"bold":r=!0;u=!1;break;case"bold italic":r=!0;u=!0;break;case"italic":r=!1;u=!0;break;case"normal":r=!1;u=!1}toSaveOptions+="&title="+$("#selTitleFont").val()+";"+$("#selTitleFontSize").val()+";"+r+";"+u+";rgb("+l.r+","+l.g+","+l.b+");"+$("#selTitleAlignment").val()}if(h=="y"){tt=$("#selDescFontStyle").val();switch(tt){case"bold":f=!0;e=!1;break;case"bold italic":f=!0;e=!0;break;case"italic":f=!1;e=!0;break;case"normal":f=!1;e=!1}toSaveOptions+="&desc="+$("#selDescFont").val()+";"+$("#selDescFontSize").val()+";"+f+";"+e+";rgb("+a.r+","+a.g+","+a.b+");"+$("#selDescAlignment").val()}return toSaveOptions+=n!=null&&n!=""&&n=="y"?"&exptypes="+i+"&oms="+n:"&exptypes="+i,$("#hdnReportType").val().toUpperCase()=="MAP"&&(toSaveOptions+="&maplegend="+($("#chkEmbedShowLegend").prop("checked")?"Y":"N"),toSaveOptions+="&zoom="+($("#chkEmbedShowZoombar").prop("checked")?"Y":"N"),gbl_map_zoomdata!=""&&(toSaveOptions+="&zoomlevel="+gbl_map_zoomdata),gbl_map_extentdata!=""&&(toSaveOptions+="&latlon="+gbl_map_extentdata)),gbl_common_internal?$("#chkExternalAccess").is(":checked")?(it=$("#selExternalLang").val(),t=getPublishedReportsEmbedURL(it)):t=getEmbedURL():t=getEmbedURL(),o=t+(t.indexOf("?")>0?"&":"?")+toSaveOptions,rt="<iframe frameBorder='no' src=\""+o+'" width= "'+ct+'"  height="'+lt+'"><\/iframe>',gbl_embedsource_src=o,$("#txtEmbedCode").val(rt),o}function getEmbedURL(){var n="",t;return $("#hdnReportURL").val()!=""&&(gbl_baseurl.indexOf("localhost")>=0?(t=$("#hdnReportURL").val().split("/"),n="http://"+gbl_baseurl+gbl_embedpath.substring(1)+"reports/reportwidget.aspx?report_name="+t[0]+"&id="+t[2]):n=gbl_common_internal?"http://"+gbl_baseurl+$("#hdnReportURL").val():"http://"+gbl_baseurl+"embed/"+$("#hdnReportURL").val()),n}function getPublishedReportsEmbedURL(n){var i="",r=$("#hdnExternalUID").val(),u=$("#hdnExternalName").val(),f=$.parseJSON($("#hdnExternalDomains").val()),t=f[n];return t!=""&&(i=t.indexOf("http://localhost")>=0?t+"/Views/Reports/ReportWidgetCustom.aspx?Report_Name="+u+"&amp;Id="+r:t+"/embed-int/"+u+"/id/"+r),i}function initializeJPickerEmdebOpt(){$(".colorPickerEmdebOpt").jPicker({window:{expandable:!0},color:{alphaSupport:!0,active:new $.jPicker.Color({ahex:"#444444"})},position:{x:"screenCenter",y:"0px"}},function(n){var t=n.val("all").hex||"transparent",i=$(this).attr("id");switch(i){case"selTitleFontColor":$("#chartWrapper").contents().find("#widgetTitle").css("color","#"+t);generateCode();break;case"selDescColor":$("#chartWrapper").contents().find("#widgetDesc").css("color","#"+t);generateCode();break;case"canvasBorder":$("#chartWrapper").contents().find("#widgetpreview").css("border-color","#"+t);generateCode()}})}function generateEmbedCode(n){var u=$("#chkExternalAccess"),t=$("#divExternalLang"),i,f,r;n=="share"&&(u=$("#chkExternalAccessShare"),t=$("#divExternalLangShare"));i=u.is(":checked");i?t.show():t.hide();n=="share"?i?(f=$("#selExternalLangShare").val(),r=getPublishedReportsEmbedURL(f),$("#lnkPermReportLink").html(r),$("#lnkPermReportLink").attr("href",r)):($("#lnkPermReportLink").html(getEncodedUrl()),$("#lnkPermReportLink").attr("href",getEncodedUrl())):generateCode()}var gbl_embedsource_src=gbl_embedpath,gbl_map_zoomdata,gbl_map_extentdata;$(document).ready(function(){chooseEmbedFrameSize();showHideEntities();initAvailableThemeSel();initializeJPickerEmdebOpt()});gbl_map_zoomdata="";gbl_map_extentdata=""