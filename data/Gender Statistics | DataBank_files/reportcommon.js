function getParameterByName(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(location.search);return t==null?"":decodeURIComponent(t[1].replace(/\+/g," "))}function htmlEncode(n){return $("<div/>").text(n).html()}function htmlDecode(n){return $("<div/>").html(n).text()}function initCommon(){var i,o;$(".download").off("click");$(".download").on("click",function(n){n.stopPropagation();isdownloadlimit=!1;var t=checkvariablelimit();t?gbl_common_internal?(buildDownloadAdvanced(),$("#lblDownloadComputer").hide(),$("#lblDownloadComputer").removeClass("active"),$("#lblDownloadSaveToAccount").addClass("active"),$("#saveToAccountOptions").show(),$("#liMetadataDownloadAdvanced").hide(),$("#advancedDownloadOptions").modal("show")):isdownloadlimit?($(".selectionModifyTxt").is(":visible")&&$(".selectionModifyTxt").hide(),$("#divNoDataToDisplay").is(":visible")&&$("#divNoDataToDisplay").hide(),$(".downloadMsg").show()):(buildDownloadAdvanced(),$("#advancedDownloadOptions").modal("show")):$("#downloadDropdown").slideToggle()});$(".cancelChangesDim").off("click");$(".cancelChangesDim").on("click",function(){document.getElementById("selModifyText").innerHTML=gbl_common_labels.Reports_Label_Selection_Modified;$.each(gbl_array_member_selected_clone,function(n,t){var i=n,r="#tbl_"+i,u;$(r).parent().find(".selectedView").html("");gbl_array_member_selected[i]=jQuery.extend(!0,{},t);$("#tbl_"+i).find("li.selected").removeClass("selected");$("#tbl_"+i).find(".chkSelectElement").prop({checked:!1});u=gbl_array_member_selected[i];$.each(u,function(n,t){if(!t.iscustom){var r=$("#tbl_"+i).find("li[uniqueid='"+n+"']");r.addClass("selected");r.find("input").prop({checked:!0})}});getSelectedMembers(i,r)});var n=$("#hdnReportType").val().toUpperCase();switch(n){case"TABLE":setTableOptions();$("#formatSeries").hasClass("collapse")||$("#btnFormatSeries").trigger("click");$("#formatSeries").html("");$("#comparatorReport").hasClass("collapse")||$("#btnComparatorReport").trigger("click");$("#comparatorReport").html("");$("#hideColumns").hasClass("collapse")||$("#btnHideColumns").trigger("click");$("#hideColumns").html("");break;case"CHART":setChartOptions();$("#formatSeries").hasClass("collapse")||$("#btnFormatSeries").trigger("click");$("#formatSeries").html("");$("#comparatorReport").hasClass("collapse")||$("#btnComparatorReport").trigger("click");$("#comparatorReport").html("");$("#xAxisOptions").hasClass("collapse")||$("#btnXaxis").trigger("click");$("#divXAxisFormatAdvanced").html("")}$(".selectionModifyTxt").is(":visible")&&$(".selectionModifyTxt").hide();$(".confirmationTxt").is(":visible")&&$(".confirmationTxt").hide();$("#faded").hide()});$(".applyChangesDim").off("click");$(".applyChangesDim").on("click",function(){var r=$("#hdnSelectVars").val()==""?"[]":$("#hdnSelectVars").val(),i,t,n;if(document.getElementById("selModifyText").innerHTML=gbl_common_labels.Reports_Label_Selection_Modified,onUpdateVarsClick())if(i=0,$(".selectionCountRHS").each(function(){var n=eval($(this).text());(n==null||n<1||n=="")&&i++}),i>0)listUnselectedVariables(!1),$("#divNoDataToDisplay").show(),$("#cbpReportView").hide(),$("#upReportDD").hide(),$(".selectionModifyTxt").hide(),$(".faded").show();else{t=$("#hdnReportType").val().toUpperCase();switch(t){case"TABLE":if(!onUpdateTableOptionsClick())return;break;case"CHART":if(!onUpdateChartOptionsClick())return}$(".formatList .download,.formatList .download a").removeClass("disabled");$(".selectionModifyTxt").hide();$("#faded").hide();n=r!=$("#hdnSelectVars").val();t!="METADATA"||n?t=="TABLE"?n=!0:t=="CHART"&&(n=!0):(n=gbl_metadata_attr_changed,gbl_metadata_attr_changed=!1);n&&__doPostBack("lnkUpdateVarsOpts","")}else listUnselectedVariables(!1)});$(".confirmOK").off("click");$(".confirmOK").on("click",function(){$(".confirmationTxt").hide();__doPostBack("lnkChart","")});var i=$("#hdnReportType").val().toUpperCase(),r="",u="",e="",f="",n="",t="";i=="TABLE"?(r+=" #divTablePopularOrientation .btn, #divRowsPerPage .btn,",r+=" #chkShowNotes, #chkCommaSep, #chkTableHideEmptyRow, #chkTableHideEmptyCol",u+=" .custom-orientation-ddl, #ddlNAPref, #ddlScale, #ddlPrecision,",u+=" #ddlTableHierarchy, #ddlTableMRVFunc, #ddlTableMRVInt",e+=" #txtReportHeader, #txtReportFooter, #txtReportNotes"):i=="CHART"?(r+=" #divChartPopularOrientation .btn",u+=" .custom-orientation-ddl, #ddlScale, #ddlPrecision",e+="",f+=" #chkAutoAdjust, #chkShowGridLines, #chkShowTooltip, #chkShowDataPointsChart, #chkShowLegend,",f+=" #chkShowNavigator, #chkCommaSep, #chkShowXAxisLine, #chartStyles .btn,#chkShowDataPointTooltip",n+=" #ddlChartType,#ddlSharedToolTip",t+=" #txtWidth, #txtHeight, #txtXaxisInterval, #txtNavigatorHeight,",t+=" #txtYaxisprimaryscalesettingmin, #txtYaxisprimaryscalesettingmax, #txtYaxissecondaryscalesettingmin, #txtYaxissecondaryscalesettingmax,",t+=" #txtReportHeader, #txtReportFooter",typeof getChartOptionsAdvanced==typeof Function&&(r+=" ,#chkHideEmptyColumns, #chkHideEmptyRows, #chkAllDataValue, #lblYAxisApplyAll, #radioYAxisApplyAll",u+=" ,#ddlXaxisprimaryweekday, #ddlXaxisprimaryDay, #ddlXaxisprimaryMonth, #ddlXaxisprimaryYear, #ddlAllChartType, #ddlAllAxis",e+=" #txtXaxisprimarycustomdateformat",f+=" ,#chkShowChartBorder, #chkDottedGridlines, #chartLegend .btn, #chkXaxisline, #chkXaxisprimarymultiline",n+=" ,#ddlZoominDataChart, #ddlchartLegendFontStyle, #ddlchartLegendFontType, #ddlchartLegendFontSize, #ddlchartLegendVerticalAlign, #ddlchartLegendHorizontalAlign",n+=" ,#ddlXaxisprimarylabelfontType, #ddlXaxisprimarylabelfontStyle, #ddlXaxisprimarylabelfontSize, #ddlXaxisprimarytitlefontStyle",n+=" ,#ddlXaxisprimarytitlefontType, #ddlXaxisprimarytitlefontSize",n+=" ,#ddlYaxisprimarylabelfontStyle, #ddlYaxisprimarylabelfontType, #ddlYaxisprimarylabelfontSize",n+=" ,#ddlYaxisprimarytitlefontStyle, #ddlYaxisprimarytitlefontType, #ddlYaxisprimarytitlefontSize",n+=" ,#ddlYaxissecondarylabelfontStyle, #ddlYaxissecondarylabelfontType, #ddlYaxissecondarylabelfontSize",n+=" ,#ddlYaxissecondarytitlefontStyle, #ddlYaxissecondarytitlefontType, #ddlYaxissecondarytitlefontSize",t+=" ,#txtXaxisPrimarylabelInterval, #txtXaxisprimarylabelrotation, #txtXaxisprimarytitle, #txtXaxisprimarytickInterval",t+=" ,#txtYaxisPrimarylabelInterval, #txtYaxisprimarylabelrotation, #txtYaxisprimarypointwidth, #txtYaxisprimarygrouppadding",t+=" ,#txtYaxisprimarytitle, #txtYaxisprimarytickInterval, #txtYaxisprimaryscalesettingmin, #txtYaxisprimaryscalesettingmax",t+=" ,#txtYaxissecondarylabelInterval, #txtYaxissecondarylabelrotation",t+=" ,#txtYaxissecondarytitle, #txtYaxissecondarytickInterval, #txtYaxissecondaryscalesettingmin, #txtYaxissecondaryscalesettingmax")):i=="MAP"||i=="METADATA"&&(f+=" #metadata-orientation .btn");attachTrackerEvents(r,u,e,f,n,t);$("body").off("click",".radioSelectElement");$("body").on("click",".radioSelectElement",function(){var t;$(this).parents(".availableView").find("li").removeClass("selected");$(this).parents("li").addClass("active");var i=$("#tbl_sel_DBList li.selected").attr("uniqueid"),r=$("#tbl_DBList input:checked").parent().attr("uniqueid"),n=$("#tbl_DBList input:checked").parent().attr("source").replace("&","and");n=n.split("-").join("~").replace(/\s/g,"-").toLowerCase();t=$("#hdnReportType").val();i!=r&&confirm("If the current report is not saved, please save before proceeding. This will change the database and you may lose your current selections and formatting. Do you wish to proceed?")&&($("#report-loading").show(),window.location.href=$('#btnDBPreview input[name="previewoption"]:checked').val()=="ON"?"reports.aspx?source="+n+"&Type="+t+"&preview=on":"reports.aspx?source="+n);toggleFilterHierarchy()});$("#btnDownloadAdvanced").off("click");$("#btnDownloadAdvanced").on("click",function(){if(hasclearedallselections(!0))return!1;buildDownloadAdvanced();$("#advancedDownloadOptions").modal("show")});$("#lnkPermReportLink").html(getEncodedUrl());$("#lnkPermReportLink").attr("href",getEncodedUrl());$("#tooltipDialog").hide();i=$("#hdnReportType").val().toUpperCase();i=="MAP"?($("#divMapRegionPanel").show(),$("#divMapIncomePanel").show()):($("#divMapRegionPanel").hide(),$("#divMapIncomePanel").hide());switch(gbl_selectedTabOnSwitch){case"liVariables":setActiveTab_Main("#liVariables","#selection");break;case"liLayout":setActiveTab_Main("#liLayout","#reportOptions");break;case"liStyles":i=="MAP"||i=="CHART"?setActiveTab_Main("#liStyles","#themes"):setActiveTab_Main("#liVariables","#selection");break;case"liEmbed":setActiveTab_Main("#liEmbed","#embed");break;case"liShare":setActiveTab_Main("#liShare","#share");break;case"liSave":setActiveTab_Main("#liSave","#save")}$("#hdnSaveDlg").val()==1&&(setActiveTab_Main("#liSave","#save"),$("#hdnSaveDlg").val(0));showHideLangBar();onNoPreviewSelected();resetCustomGrpSel();$("#txtSaveReportDesc").keypress(function(n){return globalValidateKeyChars(n)});$("#txtSaveReportTitle").keypress(function(n){return globalValidateKeyChars2(n)});$("#txtNewFolderName").keypress(function(n){return globalValidateKeyChars(n)});$("#txtSaveReportDesc").change(function(){var n=globalEvalString($("#txtSaveReportDesc").val());$("#txtSaveReportDesc").val(n)});$("#txtSaveReportTitle").change(function(){var n=globalEvalString2($("#txtSaveReportTitle").val());$("#txtSaveReportTitle").val(n)});$("#txtNewFolderName").change(function(){var n=globalEvalString($("#txtNewFolderName").val());$("#txtNewFolderName").val(n)});o=checkvariablelimit();o?($("#faded").show(),$(".downloadMsg").show(),$(".page-ddl").hide(),$(".selectionModifyTxt").is(":visible")&&$(".selectionModifyTxt").hide(),$("#divNoDataToDisplay").is(":visible")&&$("#divNoDataToDisplay").hide(),$(".formatList #liTable,.formatList #liTable a").addClass("disabled"),$(".formatList #liTable,.formatList #liTable a").removeClass("active"),$(".formatList #liChart,.formatList #liChart a").addClass("disabled"),$(".formatList #liMap,.formatList #liMap a").addClass("disabled"),$(".formatList #liMetadata,.formatList #liMetadata a").addClass("disabled")):($("#faded").hide(),$(".downloadMsg").hide(),$(".formatList #liTable,.formatList #liTable a").removeClass("disabled"),$(".formatList #liChart,.formatList #liChart a").removeClass("disabled"),$(".formatList #liMap,.formatList #liMap a").removeClass("disabled"),$(".formatList #liMetadata,.formatList #liMetadata a").removeClass("disabled"));$("body").on("click",function(){$("#downloadDropdown").slideUp()});$("#downloadDropdown").click(function(n){n.stopPropagation()})}function doClientOptions(n,t){var i=$("#hdnReportType").val().toUpperCase();switch(i){case"CHART":setChartOptionsPartial();break;case"MAP":setMapOptionsPartial(n);t("","","",!0,!1,!1);break;case"METADATA":onUpdateMetadataOptionsClick(n.id)}}function attachTrackerEvents(n,t,i,r,u,f,e){if(n!=""){$(n).off("click");$(n).on("click",function(n){n.button!=null&&showOptionsChanged()})}if(r!=""){$(r).off("click");$(r).on("click",function(n){n.button!=null&&($("#report-loading").show(),setTimeout(function(){doClientOptions(this,e)},200))})}if(t!=""){$(t).off("change");$(t).on("change",function(){showOptionsChanged()})}if(u!=""){$(u).off("change");$(u).on("change",function(){$("#report-loading").show();doClientOptions(this,e)})}if(i!=""){$(i).off("change");$(i).on("change",function(){showOptionsChanged()})}if(f!=""){$(f).off("change");$(f).on("change",function(){$("#report-loading").show();doClientOptions(this,e)})}}function showOptionsChanged(){$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide();$("#divNoDataToDisplay").is(":visible")&&$("#divNoDataToDisplay").hide()}function onReportClicked(n){var r,t,i,u;if(gbl_selectedTabOnSwitch=$("#liPrimaryToolTab").find("li.active").attr("id"),r=getCookie("preview"),$("#hdnReportID").val()!=""||r!="N"||$(".selectionModifyTxt").is(":visible")||(t=0,$(".selectionCountRHS").each(function(){var n=eval($(this).text());(n==null||n<1||n=="")&&t++}),t==0&&$(".applyChangesDim").trigger("click")),hasclearedallselections(!1))return!1;if(n.id=="lnkChart"){if(hasnesteddimension())return!1;if(i=!1,u=$('.variableTable.selectedView[data-type="S"]').attr("data-value"),$(".page-ddl").attr("id")!=null&&$(".page-ddl").attr("id").indexOf(u)>=0&&(i=!0),gbl_HasIndicatorUnit&&!i&&!validateBookUnits())return $(".confirmationTxt").show(),!1}return gbl_subnat_loadextent=!0,!0}function hasnesteddimension(){var n=!1;return $.ajax({type:"POST",url:gbl_report_methods+"/HasNestedDimension",contentType:"application/json; charset=utf-8",data:"{lang: '"+gbl_common_culture+"'}",async:!1,dataType:"json",success:function(t){t.d!=""&&(alert(t.d),n=!0)},error:function(){window.location.href="ddperror.aspx"}}),n}function onClearSelections(){var n=confirm(gbl_msg_clear_selection);n&&($.ajax({type:"POST",url:gbl_report_methods+"/ClearSelections",contentType:"application/json; charset=utf-8",data:"",dataType:"json",success:function(n){n.d==""?clearselections():alert(n.d)},error:function(){window.location.href="ddperror.aspx"}}),$("#availableDimensions li").removeClass("selected"),listUnselectedVariables(!0),$(".clearSelTxt").show(),$(".noPreview").hide())}function clearselections(){gbl_clear_selections=!0;gbl_array_member_selected={};$(".selectedView").each(function(n,t){var i=t.id.replace("tbl_sel_","");i!="MetaAttr"&&i!="DBList"&&($("#panel_"+i+" .selectionCount").html("&nbsp;"),$("#tbl_sel_"+i).html(""),$("#tbl_"+i+" li.selected input").prop({checked:!1}),$("#tbl_"+i+" li.selected").removeClass("selected"))});$("#upReportDD").hide();$("#cbpReportView").hide();$("#divNoDataToDisplay").show();$(".faded").show();$(".report-view").html("");$(".selectionCountRHS").text("")}function hasclearedallselections(n){if(gbl_clear_selections){var t=!1;return $(".selectedView").each(function(n,i){var r=i.id.replace("tbl_sel_",""),u;r!="MetaAttr"&&r!="DBList"&&(u=gbl_array_member_selected[r],(u==null||Object.keys(u).length<=0)&&(t=!0))}),t||n||$.ajax({type:"POST",url:gbl_report_methods+"/HasReportSelections",contentType:"application/json; charset=utf-8",data:"",async:!1,dataType:"json",success:function(n){n.d==""?gbl_clear_selections=!1:t=!0},error:function(){window.location.href="ddperror.aspx"}}),t}return!1}function onLangSelection(n){if($("#hdnuidval").val()=="")return getLangUIDValue(n,!1),!1;var t=$("#frmMain")[0],i=$("#hdnlangdmn"+n).val();return $("#hdntgurl").val(i+$("#hdntgpgnam").val()),t.action=i+gbl_common_chglang,$("#__VIEWSTATE").val(""),t.submit(function(){return!1}),!1}function getLangUIDValue(n,t){$.ajax({type:"POST",url:"reports.aspx/getLangUIDValue",contentType:"application/json; charset=utf-8",data:"",dataType:"json",success:function(i){$("#hdnuidval").val(i.d);t?onLangSelectionLogin(n):onLangSelection(n)},error:function(){$("#hdnuidval").val("");window.location.href="ddperror.aspx"}})}function onLangSelectionLogin(n){if($("#hdnuidval").val()=="")return getLangUIDValue(n,!0),!1;var t=$("#frmMain")[0],i=$("#hdnlangdmn"+n).val();return $("#hdntgurl").val(gbl_common_loginparam),t.action=gbl_common_refpath,$("#__VIEWSTATE").val(""),t.submit(function(){return!1}),!1}function setReportSize(n){switch($("#hdnReportType").val().toUpperCase()){case"TABLE":typeof setTableSize==typeof Function&&setTableSize();break;case"MAP":if(n&&!gbl_map_splitter_initial&&$(".openBtn").is(":visible")){var t=map.getZoom();t==2&&($(".esriSimpleSliderIncrementButton").trigger("click"),gbl_map_zoomdown=!0)}else typeof setMapSize==typeof Function&&setMapSize(!0,!1),gbl_map_splitter_initial=!1;break;case"CHART":typeof setChartSize==typeof Function&&setChartSize()}}function loadReportLabels(){$("#dpSelectLabel").val().trim()=="select"&&($("#report-loading").fadeIn(100),$("#dpSelectLabel").html("<option>Loading...<\/option>"),$.ajax({type:"POST",url:gbl_report_methods+"/GetReportLabels",contentType:"application/json; charset=utf-8",async:!1,data:"",dataType:"json",success:function(n){if($("#dpSelectLabel").html(""),n.d!=""){var t=n.d.split("|");$ctl_label=$("#dpSelectLabel");t.length>=1&&$.each(t,function(n,t){var i=t.split("^"),r=i[0],u=i[1];$ctl_label.append($("<option><\/option>").val(r).html(u))})}},error:function(){$("#dpSelectLabel").html("");window.location.href="ddperror.aspx"}}),$("#report-loading").hide())}function onVarTabClick(){setActiveTab_Main("#liVariables","#selection");gbl_selectedTabOnSwitch="liVariables";$("#embedIframeWrapper").hide();$("#divReportContent").show();$(".addRemoveVariables").show()}function onLayoutTabClick(){setActiveTab_Main("#liLayout","#reportOptions");gbl_selectedTabOnSwitch="liLayout";$("#embedIframeWrapper").hide();$("#divReportContent").show();$(".addRemoveVariables").show()}function onStylesTabClick(){setActiveTab_Main("#liStyles","#themes");gbl_selectedTabOnSwitch="liStyles";$("#embedIframeWrapper").hide();$("#divReportContent").show();$(".addRemoveVariables").show()}function onSaveTabClick(){if(!gbl_common_loggedin)return RedirectMCSave(gbl_common_login,gbl_tooltip_loginsave);setActiveTab_Main("#liSave","#save");gbl_selectedTabOnSwitch="liSave";$("#embedIframeWrapper").hide();$("#divReportContent").show();$(".addRemoveVariables").show();loadReportLabels();var t=$("#hdnReportType").val(),n=$("#hdnReportDetails").val();n!=null&&n!=""&&(n=$.parseJSON(n),n!=null&&n.ReportType==t?($("#txtSaveReportTitle").val(n.ReportName),$("#txtSaveReportDesc").val(n.ReportDesc),$("#chkShareReport").prop({checked:n.ShareReport}),$("#chkSnapshotSave").prop({checked:n.Snapshot}),$("#dpSelectLabel").val(n.ReportLabelID)):clearReportSave(!1))}function saveReport(){var n;if(hasclearedallselections(!1))return!1;$("#report-loading").show();var f=$("#hdnReportID").val(),r=$("#hdnReportType").val(),t=$("#hdnReportDetails").val();t!=null&&t!=""&&(t=$.parseJSON(t),t!=null&&t.ReportType!=r&&(f=""));var e=$("#txtSaveReportTitle").val(),s=$("#txtSaveReportDesc").val(),h=$("#chkShareReport").prop("checked"),u=$("#chkSnapshotSave").prop("checked"),i=$("#divLabelSelection label.active").attr("id")=="btnCreateNewFolder",c=i?0:$("#dpSelectLabel").val()==null?0:$("#dpSelectLabel").val(),o=i?$("#txtNewFolderName").val():$("#dpSelectLabel option:selected").text();if(!i&&$("#dpSelectLabel option:selected").val()=="select")return alert(gbl_msg_select_label),$("#report-loading").hide(),!1;if(i&&o=="")return alert(gbl_msg_new_label),$("#report-loading").hide(),!1;u==null&&(u=!1);n="";r.toUpperCase()=="MAP"?(n={Extent:$("#hdnExtentData").val(),BaseMapStyle:$("#hdnBaseMapStyle").val(),LegendDragPosition:$("#hdnLegendDragPosition").val()},n=JSON.stringify(n)):r.toUpperCase()=="TABLE"&&($("#hdnTableFormatStyles").val()!=""||$("#hdnTableFormatRows").val())&&(n={cellstyles:$("#hdnTableFormatStyles").val(),insertrows:$("#hdnTableFormatRows").val()},n=JSON.stringify(n));$.ajax({type:"POST",url:gbl_report_methods+"/SaveReport",contentType:"application/json; charset=utf-8",data:"{reportid: '"+f+"', reporttype: '"+r+"', reporttitle: '"+e+"', reportdescription: '"+s+"', sharereport: "+h+", snapshot: "+u+", newfolder: "+i+", labelid: "+c+", labeltext: '"+o+"', reportoptions: '"+n+"'}",dataType:"json",success:function(n){if(n.d.IsSaved){$("#divReportSaveSucess").show();$("#divReportSaveFailed").hide();$("#txtReportSaveSucess").text(n.d.SuccessMessage);i&&($("#dpSelectLabel").html(""),$("#dpSelectLabel").append($("<option><\/option>").val("select").html("-Select-")),loadReportLabels());$(".reportName").html(e);$("#hdnReportDetails").val(n.d.ReportDetails);var t=$.parseJSON(n.d.ReportDetails);$("#hdnReportID").val(t.ReportID);$("#hdnReportURL").val(t.ReportURL);$("#lnkPermReportLink").html(getEncodedUrl());$("#lnkPermReportLink").attr("href",getEncodedUrl())}else $("#divReportSaveSucess").hide(),$("#divReportSaveFailed").show(),$("#txtReportSaveFailed").text(n.d.ErrorMessage);$("#report-loading").hide()},error:function(n,t,i){window.location.href="ddperror.aspx";$("#divReportSaveSucess").hide();$("#divReportSaveFailed").show();$("#txtReportSaveFailed").text(i);$("#report-loading").hide()}})}function clearReportSave(n){(!n||confirm("Clear the values?"))&&($("#txtSaveReportTitle").val(""),$("#txtSaveReportDesc").val(""),$("#chkShareReport").prop({checked:!1}),$("#chkSnapshotSave").prop({checked:!1}),$("#btnAssignExistingFolder").trigger("click"),$("#dpSelectLabel").val($("#dpSelectLabel option:first").val()),$("#txtNewFolderName").val(""))}function onShareTabClick(){var t,i,n;if($("#embedIframeWrapper").hide(),$("#divReportContent").show(),hasclearedallselections(!1))return!1;if(t=$("#hdnReportURL").val()=="",t||(i=$("#hdnReportType").val(),n=$("#hdnReportDetails").val(),n!=null&&n!=""?(n=$.parseJSON(n),t=n!=null?n.ReportType!=i:!0):t=!0),t){if(!gbl_common_loggedin)return RedirectMCSave(gbl_common_login,gbl_tooltip_loginsave);switch($("#hdnReportType").val().toUpperCase()){case"TABLE":case"METADATA":alert(gbl_msg_save_table);$("#lnkPermReportLink").html(gbl_msg_save_table);break;case"CHART":alert(gbl_msg_save_chart);$("#lnkPermReportLink").html(gbl_msg_save_chart);break;case"MAP":alert(gbl_msg_save_map);$("#lnkPermReportLink").html(gbl_msg_save_map)}return setActiveTab_Main("#liSave","#save"),!1}return setActiveTab_Main("#liShare","#share"),gbl_selectedTabOnSwitch="liShare",!0}function onEmbedTabClick(){onShareTabClick()&&($("#embedIframeWrapper").show(),$("#divReportContent").hide(),$(".addRemoveVariables").hide(),$("#hdnReportType").val()=="METADATA"?$("#divMetadataDimensionDpDwn").show():$("#divMetadataDimensionDpDwn").hide(),showembedloading(),$("#chartWrapper").attr("src",generateCode()),setActiveTab_Main("#liEmbed","#embed"),gbl_selectedTabOnSwitch="liEmbed");$("#hdnReportType").val().toUpperCase()=="MAP"?(killWidgetByID("tooltipDialog"),$("#chkEmbedShowZoombar").prop({checked:$("#chkShowZoombar").prop("checked")}),$("#chkEmbedShowLegend").prop({checked:$("#divMapLegend label.active input").prop("id")=="rdShowLegend"}),$("#chkEmbedShowZoombar").parent().parent().show(),$("#chkEmbedShowLegend").parent().parent().show()):($("#chkEmbedShowZoombar").parent().parent().hide(),$("#chkEmbedShowLegend").parent().parent().hide())}function Entertwitter(){window.open("http://twitter.com/share?url="+encodeURIComponent(getEncodedUrl())+"&text="+encodeURIComponent(getReportDisplayName()),"_new")}function Enterfacebook(){window.open("http://www.facebook.com/share.php?u="+encodeURIComponent(getEncodedUrl())+"&t="+encodeURIComponent(getReportDisplayName()),"_new")}function EnterGoogleplus(){window.open("http://plus.google.com/share?url="+encodeURIComponent(getEncodedUrl())+"&title="+encodeURIComponent(getReportDisplayName()),"_new")}function getEncodedUrl(){return gbl_basepath+$("#hdnReportURL").val()}function getReportDisplayName(){var n=$("#hdnReportDetails").val();return n!=null&&n!=""&&(n=$.parseJSON(n),n!=null)?n.ReportName:""}function loadMetaData(n,t,i){var r='<div style="width: 100%; text-align: center;">'+$("#report-loading").html()+"<div>";$("#divMetadataCtl div.modal-body").html(r);$("#divMetadataCtl").attr("selection","report");$.ajax({type:"POST",url:gbl_report_methods+"/PopulateMetaDataJSON",contentType:"application/json; charset=utf-8",data:"{name:'"+n.replace(/\'/g,"%27")+"', code:'"+t+"', dimensiontype:'"+i+"', lang:'"+gbl_common_culture+"'}",dataType:"json",success:function(r){r.d!=null&&r.d!=""&&($("#divMetadataCtl div.modal-body").html(r.d),$("#gdp-meta-data-rpt").css("max-height",Math.round($(window).height()*.5)+"px").css("overflow","auto"),$("#gdp-meta-data-rpt #metadata-specific-data").css("max-height","").css("overflow",""),$("#divMetadataCtl .btn-meta-download").show(),gbl_download_name=n,gbl_download_code=t,gbl_download_type=i)},error:function(){window.location.href=gbl_error_file}})}function loadFootNotes(n,t){var i='<div style="width: 100%; text-align: center;">'+$("#report-loading").html()+"<div>";$("#divMetadataCtl div.modal-body").html(i);$("#lblMetadataLabel").html("Footnotes");$.ajax({type:"POST",url:gbl_report_methods+"/PopulateFootNotesJSON",contentType:"application/json; charset=utf-8",data:"{code:'"+n+"', lang:'"+gbl_common_culture+"'}",dataType:"json",success:function(n){n.d!=null&&n.d!=""&&($("#divMetadataCtl div.modal-body").html(n.d),t!=""&&$("#gdp-meta-data-rpt").prepend("Data are for : "+t),$("#gdp-meta-data-rpt").css("max-height",Math.round($(window).height()*.5)+"px").css("overflow","auto"),$("#divMetadataCtl .btn-meta-download").hide())},error:function(){window.location.href=gbl_error_file}})}function loadLeastSquareNote(n){$("#divMetadataCtl div.modal-body").html($(n).attr("title"));$("#divMetadataCtl .btn-meta-download").hide()}function onMetadataDownload(){var n="variable";$("#divMetadataCtl").attr("selection")!=null&&(n=$("#divMetadataCtl").attr("selection"));$.ajax({type:"POST",url:gbl_fileinfo_url,cache:!1,data:"reqtype=metadata-select&from="+n+"&name="+gbl_download_name+"&code="+gbl_download_code+"&dimtype="+gbl_download_type,beforeSend:function(){},complete:function(){},success:function(n){var t,i,r,u;n?(t=n.split("&"),typeof s_account!="undefined"&&s_account!=null&&s_account!=""&&t!=null&&t.length>0&&(i=$(".database h2").text().trim(),r="Table",$(".formatList li.active").attr("id")!=null&&(r=$(".formatList li.active").attr("id").split("li")[1].trim()),u=s_prop1,s_linkType="d",s_linkName=i+">"+r+">Metadata>Excel>"+t[0].replace("filename=",""),s_prop1=i+">Download",s_lnk=s_co(window.location),s_gs(s_account),s_prop1=u),$("#dlgDownloadFrame").get(0).src=gbl_filedown_url+"?"+n):alert("Metadata not available")},error:function(){window.location.href="ddperror.aspx"}})}function onDataDownload(n){if(hasclearedallselections(!0))return!1;updatevariablesfordownload();var t;t=n=="metadata"?"reqtype=metadata&meta-down-radio=meta-all&excel-format=xlsx":"reqtype=data&data-option-radio=data-download&ddl-excel-format=xlsx&ddl-export-range=full&ddl-data-format=Table&ddl-variable-format=Both&ddl-na-preference=..&ddl-text-delimiter=None&ddl-export-notes=N&down-radio="+n;$("#report-loading").show();$.ajax({type:"POST",url:gbl_fileinfo_url,cache:!1,data:t,beforeSend:function(){},complete:function(){},success:function(n){var t,u;if(n){if($("#dlgDownloadFrame").get(0).src=gbl_filedown_url+"?"+n,$("#report-loading").hide(),t=n.split("&"),typeof s_account!="undefined"&&s_account!=null&&s_account!=""&&t!=null&&t.length>0){var i=$(".database h2").text().trim(),f=t[1].replace("filetype=",""),r="Table";$(".formatList li.active").attr("id")!=null&&(r=$(".formatList li.active").attr("id").split("li")[1].trim());u=s_prop1;s_linkType="d";s_linkName=i+">"+r+">"+f+">"+t[0].replace("filename=","");s_prop1=i+">Download";s_lnk=s_co(window.location);s_gs(s_account);s_prop1=u}}else $("#report-loading").hide(),alert("Download not available")},error:function(){window.location.href="ddperror.aspx"}})}function onFormattedDownload(){var n,t,i;if(hasclearedallselections(!1))return!1;typeof s_account!="undefined"&&s_account!=null&&s_account!=""&&(n=$(".database h2").text().trim(),t="Table",$(".formatList li.active").attr("id")!=null&&(t=$(".formatList li.active").attr("id").split("li")[1].trim()),i=s_prop1,s_linkType="d",s_linkName=n+">"+t+">Excel>Data on this page only - Formatted",s_prop1=n+">Download",s_lnk=s_co(window.location),s_gs(s_account),s_prop1=i);__doPostBack("ExportFormattedData","")}function downloadadvanced(){var n="",c,e,r,t,u,o,s,i,a;if($("#liDataDownload").hasClass("active")){c=$("#downloadFormatTab").find(".radioBtnTabs.active").attr("id");switch(c){case"lblExcel":n="Excel";break;case"lblTab":n="Tabbed TXT";break;case"lblCSV":n="CSV";break;case"lblSDMX":n="SDMX"}}else n="Excel";if(hasclearedallselections(!0))return!1;if(updatevariablesfordownload(),e="data",$("#liDataDownload").hasClass("active")){if($("#hdnDatasetOptions").val()=="Y"&&(s="on"),$("#lblDownloadComputer").hasClass("active")||!gbl_common_internal)u="data-download";else if(u="data-export",o=$("#txtDatasetName").val(),$("#txtDatasetName").val()!=""){if(!checkSpecialCharacters($("#txtDatasetName")))return!1}else return $("#txtDatasetName").addClass("ui-state-error"),$("#divDatasetSaveSucess").hide(),$("#divDatasetSaveFailed").show(),$("#txtDatasetSaveFailed").text(gbl_msg_dataset_validation),!1;if($("#lblExcel").hasClass("active"))t="excel",r="data-option-radio="+u+"&down-radio="+t+"&ddl-excel-format="+$("#ddl-excel-format").val()+"&ddl-export-range="+$("#ddl-export-range").val()+"&ddl-data-format="+$("#ddl-data-format").val()+"&ddl-variable-format="+$("#ddl-variable-format").val()+"&ddl-na-preference="+$("#ddl-na-preference").val()+"&hdnEditMode="+s+"&ddl-export-notes="+$("#ddl-export-notes").val()+"&dataset-name="+o+"&chk-scale-precision="+($("#chk-scale-precision").prop("checked")?"Y":"N");else if($("#lblTab").hasClass("active")||$("#lblCSV").hasClass("active"))t=$("#lblTab").hasClass("active")?"tab":"csv",r="data-option-radio="+u+"&down-radio="+t+"&ddl-text-delimiter="+$("#tab-ddl-text-delimiter").val()+"&ddl-export-range="+$("#tab-ddl-export-range").val()+"&ddl-data-format="+$("#tab-ddl-data-format").val()+"&ddl-variable-format="+$("#tab-ddl-variable-format").val()+"&ddl-na-preference="+$("#tab-ddl-na-preference").val()+"&hdnEditMode="+s+"&ddl-export-notes="+$("#tab-ddl-export-notes").val()+"&dataset-name="+o+"&chk-scale-precision="+($("#chk-scale-precision").prop("checked")?"Y":"N");else if($("#lblSDMX").hasClass("active")&&(t="sdmx",r="data-option-radio="+u+"&down-radio="+t+"&ddl-sdmx-range="+$("#ddl-sdmx-range").val()+"&ddl-sdmx-type="+$("#ddl-sdmx-type").val()+"&sender-org-name="+$("#sender-org-name").val()+"&sender-org-id="+$("#sender-org-id").val()+"&sender-name="+$("#sender-name").val()+"&sender-dept="+$("#sender-dept").val()+"&sender-role="+$("#sender-role").val()+"&sender-phone="+$("#sender-phone").val()+"&sender-email="+$("#sender-email").val()+"&receiver-org-name="+$("#receiver-org-name").val()+"&receiver-org-id="+$("#receiver-org-id").val()+"&receiver-name="+$("#receiver-name").val()+"&hdnEditMode="+s+"&receiver-dept="+$("#receiver-dept").val()+"&receiver-role="+$("#receiver-role").val()+"&receiver-phone="+$("#receiver-phone").val()+"&receiver-email="+$("#receiver-email").val()+"&sdmx-dataset-name="+o,!validateSDMX()))return!1}else if($("#liMetadataDownloadAdvanced").hasClass("active")){e="metadata";var f="",h="",l="";$("#lblCustomMetadata").hasClass("active")?(f=$("#customMetadata label.active").attr("id"),f=f.replace("lblMetaCustom",""),i=$("#selectDimension").val(),i.indexOf("comb_")==0&&(i=i.substring(5)),a=getMetadataFilters(i),h=f=="excel"?$("#ddlExcelCustomFormat").val():f,l="&selectedmetatype="+i+"&metafilters="+a):h=$("#metadata-excel-format").val();r="meta-down-radio=meta-all&excel-format="+h+l}$("#report-loading").show();$.ajax({type:"POST",url:gbl_fileinfo_url,cache:!1,data:"reqtype="+e+"&"+r,beforeSend:function(){},complete:function(){},success:function(t){var i,r,u,f;if($("#report-loading").hide(),t)if(e!="metadata"&&$("#lblDownloadSaveToAccount").hasClass("active")){if(t.indexOf("Download Error:")==0)return $("#divDatasetSaveSucess").hide(),$("#divDatasetSaveFailed").show(),$("#txtDatasetSaveFailed").text(t),!1;$("#divDatasetSaveSucess").show();$("#divDatasetSaveFailed").hide();$("#txtDatasetSaveSucess").text(t)}else i=t.split("&"),typeof s_account!="undefined"&&s_account!=null&&s_account!=""&&i!=null&&i.length>0&&(r=$(".database h2").text().trim(),u="Table",$(".formatList li.active").attr("id")!=null&&(u=$(".formatList li.active").attr("id").split("li")[1].trim()),f=s_prop1,s_linkType="d",s_linkName=r+">"+u+">"+n+">"+i[0].replace("filename=",""),s_prop1=r+">Download",s_lnk=s_co(window.location),s_gs(s_account),s_prop1=f),$("#dlgDownloadFrame").get(0).src=gbl_filedown_url+"?"+t;else $("#report-loading").hide(),alert("Download not available")},error:function(){window.location.href="ddperror.aspx"}})}function validateSDMX(){$("#sdmx_error_message").html("&nbsp;");var t="sdmx_error_message",i=$("#hdn_sdmx_error_message_telephone").val(),r=$("#hdn_sdmx_error_message_email").val(),u=$("#sender-org-name"),f=$("#sender-org-id"),e=$("#sender-name"),o=$("#sender-dept"),s=$("#sender-role"),h=$("#sender-phone"),c=$("#sender-email"),l=$("#receiver-org-name"),a=$("#receiver-org-id"),v=$("#receiver-name"),y=$("#receiver-dept"),p=$("#receiver-role"),w=$("#receiver-phone"),b=$("#receiver-email"),n=!0;return n=n&&checkSpecialCharacters(u,t),n=n&&checkSpecialCharacters(f,t),n=n&&checkSpecialCharacters(e,t),n=n&&checkSpecialCharacters(o,t),n=n&&checkSpecialCharacters(s,t),n=n&&checkRegExp(h,/^(((\+[1-9][0-9]*)?(\([0-9]+\)){1}([0-9]+){1}(\s[0-9]+)+)|((\+[1-9][0-9]*)?(\([0-9]+\)){1}([0-9]+){1}(-[0-9]+)+)|((\+[1-9][0-9]*\s)?([0-9]+){1}(\s[0-9]+)+)|((\+[1-9][0-9]*-)?([0-9]+){1}(-[0-9]+)+))$/g,i,t),n=n&&checkRegExp(c,/^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,6})+$/g,r,t),n=n&&checkSpecialCharacters(l,t),n=n&&checkSpecialCharacters(a,t),n=n&&checkSpecialCharacters(v,t),n=n&&checkSpecialCharacters(y,t),n=n&&checkSpecialCharacters(p,t),n=n&&checkRegExp(w,/^(((\+[1-9][0-9]*)?(\([0-9]+\)){1}([0-9]+){1}(\s[0-9]+)+)|((\+[1-9][0-9]*)?(\([0-9]+\)){1}([0-9]+){1}(-[0-9]+)+)|((\+[1-9][0-9]*\s)?([0-9]+){1}(\s[0-9]+)+)|((\+[1-9][0-9]*-)?([0-9]+){1}(-[0-9]+)+))$/g,i,t),n=n&&checkRegExp(b,/^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,6})+$/g,r,t),n?!0:!1}function checkRegExp(n,t,i,r){var f=n.val(),u=!1;return f!=""?t.test(f)?u=!0:(n.addClass("ui-state-error"),$("#"+r).html(i),u=!1):u=!0,u}function checkSpecialCharacters(n,t){var i=n.val(),r=!1;return i!=""?i.indexOf("$")!=-1||i.indexOf("~")!=-1||i.indexOf("'")!=-1||i.indexOf("&")!=-1||i.indexOf("%")!=-1||i.indexOf("\\")!=-1||i.indexOf("#")!=-1||i.indexOf('"')!=-1||i.indexOf("/")!=-1||i.indexOf("!")!=-1||i.indexOf("*")!=-1||i.indexOf("(")!=-1||i.indexOf(")")!=-1||i.indexOf("+")!=-1||i.indexOf("{")!=-1||i.indexOf("}")!=-1||i.indexOf("|")!=-1||i.indexOf(",")!=-1||i.indexOf("<")!=-1||i.indexOf(">")!=-1?(n.addClass("ui-state-error"),$("#"+t).html(document.getElementById("hdnSpecialCharacters").value),r=!1):r=!0:r=!0,r}function getSDMXTypes(){$.ajax({type:"POST",async:!1,url:gbl_fileinfo_url,cache:!1,data:"reqtype=sdmx-type",dataType:"html",success:function(n){n!=null&&n!=""?($("#lblSDMX").show(),$("#ddl-sdmx-type").html(n),$("#ddl-sdmx-type").get(0).selectedIndex=0,setDSD()):$("#lblSDMX").hide()},error:function(){$("#down-radio4").hide();$("#down-radio4-label").hide()}})}function setDSD(){var t=$("#ddl-sdmx-type option:selected"),n=t.attr("dsdname");n!=null&&n.length>0?$(".dsd-download").show():$(".dsd-download").hide()}function downloadDSD(){var n=$("#ddl-sdmx-type option:selected"),t=n.attr("dsdname"),i="?filename="+t+"&filetype=DSD";$("#dlgDownloadFrame").get(0).src=gbl_filedown_url+i}function loadDirectDialog(n,t){var r=n.attr("href"),i=$("#"+t),u=i.data("modal")?"toggle":$.extend({remote:!/#/.test(r)&&r},i.data(),n.data());i.modal(u,this).one("hide",function(){n.is(":visible")&&n.focus()})}function isHTML(n){var r=document.createElement("div"),t,i;for(r.innerHTML=n,t=r.childNodes,i=t.length;i--;)if(t[i].nodeType==1)return!0;return!1}function loadDirectMetaData(n,t,i,r){loadMetaData(t,i,r);loadDirectDialog(n,"divMetadataCtl")}function buildFormatSeriesTable(){$("#formatSeries").hasClass("collapse")&&($("#report-loading").show(),$.ajax({type:"POST",async:!1,url:"reports.aspx/GetModalFormatSeries",contentType:"application/json; charset=utf-8",data:"",dataType:"html",success:function(n){var t=$.parseJSON(n).d;$("#formatSeries").html(t);$(".series-level-scale, .series-level-precision").off("change");$(".series-level-scale, .series-level-precision").on("change",function(){$("#ddlScale").val("..");$("#ddlPrecision").val("..");$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()})},error:function(){window.location.href=gbl_error_file}}),$("#report-loading").hide())}function setSeriesScaling(){var n=null,t=null;return $("#ddlScale").val()==".."&&$("#ddlPrecision").val()==".."&&(n={},$(".series-level-scale").each(function(){n[this.id]=this.value}),t={},$(".series-level-precision").each(function(){t[this.id]=this.value})),{seriesscale:n,seriesprecision:t}}function buildDownloadAdvanced(){$("#report-loading").show();$("#divDatasetSaveSucess").hide();$("#divDatasetSaveFailed").hide();$.ajax({type:"POST",async:!1,url:"reports.aspx/GetModalDownload",contentType:"application/json; charset=utf-8",data:"",dataType:"html",success:function(n){var t=$.parseJSON(n).d;$("#divDownloadAdvanced").html(t);getSDMXTypes();$("#hdnDatasetOptions").val()=="Y"&&fillDownloadForm();$("#report-loading").hide()},error:function(){window.location.href=gbl_error_file;$("#report-loading").hide()}})}function fillDownloadForm(){$.ajax({type:"POST",async:!1,url:gbl_fileinfo_url,cache:!1,data:"reqtype=data-form",dataType:"json",success:function(n){if(n){$("#lblDownloadComputer").removeClass("active");$("#lblDownloadSaveToAccount").addClass("active");$("#saveToAccountOptions").show();var t=n[0],i=t.exportFormat;i.indexOf("SDMX")>=0?($("#lblSDMX").addClass("active"),$("#sdmxOptions").show(),$("#excelOptions").hide(),$("#tabbedTxtOptions").hide(),$("#lblExcel").removeClass("active"),$("#lblCSV").removeClass("active"),$("#lblTab").removeClass("active"),populateSDMXFields(t)):populateDataFields(t)}},error:function(){$("#error_message").html("Error retrieving previous selections");$("#hdnEditMode").val("off")}})}function populateDataFields(n){n.exportFormat.indexOf("EXCEL")>=0?($("#radioExcel").attr("checked","checked"),n.applyScale=="Y"&&$("#chk-scale-precision").attr("checked","checked"),n.excelFormat.length>0&&$("#ddl-excel-format option[value='"+n.excelFormat+"']").attr("selected","selected"),$("#ddl-variable-format option[value='"+n.variableFormat+"']").attr("selected","selected"),$("#ddl-export-range option[value='"+n.exportRange+"']").attr("selected","selected"),$("#ddl-data-format option[value='"+n.dataFormat+"']").attr("selected","selected"),$("#ddl-export-notes option[value='"+n.exportNotes+"']").attr("selected","selected"),$("#ddl-excel-format option[value='"+n.excelFormat+"']").attr("selected","selected")):(n.exportFormat.indexOf("TAB")>=0?($("#lblTab").addClass("active"),$("#tabbedTxtOptions").show(),$("#excelOptions").hide(),$("#sdmxOptions").hide(),$("#lblExcel").removeClass("active"),$("#lblCSV").removeClass("active"),$("#lblSDMX").removeClass("active")):n.exportFormat.indexOf("CSV")>=0&&($("#lblCSV").addClass("active"),$("#tabbedTxtOptions").show(),$("#excelOptions").hide(),$("#sdmxOptions").hide(),$("#lblExcel").removeClass("active"),$("#lblTab").removeClass("active"),$("#lblSDMX").removeClass("active")),n.applyScale=="Y"&&$("#tab-chk-scale-precision").attr("checked","checked"),n.excelFormat.length>0&&$("#tab-ddl-excel-format option[value='"+n.excelFormat+"']").attr("selected","selected"),$("#tab-ddl-variable-format option[value='"+n.variableFormat+"']").attr("selected","selected"),$("#tab-ddl-export-range option[value='"+n.exportRange+"']").attr("selected","selected"),$("#tab-ddl-data-format option[value='"+n.dataFormat+"']").attr("selected","selected"),$("#tab-ddl-na-preference option[value='"+n.naPreference+"']").attr("selected","selected"),$("#ddl-text-delimiter option[value='"+n.textDelimiter+"']").attr("selected","selected"),$("#tab-ddl-export-notes option[value='"+n.exportNotes+"']").attr("selected","selected"));$("#txtDatasetName").val(n.datasetName)}function populateSDMXFields(n){$("#radioSDMX").attr("checked","checked");$("#ddl-sdmx-type option[value='"+n.exportFormat+"']").attr("selected","selected");$("#ddl-sdmx-range option[value='"+n.exportRange+"']").attr("selected","selected");$("#txtDatasetName").val(n.datasetName);n.senderOrgName!=null&&$("#sender-org-name").val(n.senderOrgName);n.senderOrgID!=null&&$("#sender-org-id").val(n.senderOrgID);n.senderName!=null&&$("#sender-name").val(n.senderName);n.senderDept!=null&&$("#sender-dept").val(n.senderDept);n.senderRole!=null&&$("#sender-role").val(n.senderRole);n.senderPhone!=null&&$("#sender-phone").val(n.senderPhone);n.senderEmail!=null&&$("#sender-email").val(n.senderEmail);n.receiverOrgName!=null&&$("#receiver-org-name").val(n.receiverOrgName);n.receiverOrgID!=null&&$("#receiver-org-id").val(n.receiverOrgID);n.receiverName!=null&&$("#receiver-name").val(n.receiverName);n.receiverDept!=null&&$("#receiver-dept").val(n.receiverDept);n.receiverRole!=null&&$("#receiver-role").val(n.receiverRole);n.receiverPhone!=null&&$("#receiver-phone").val(n.receiverPhone);n.receiverEmail!=null&&$("#receiver-email").val(n.receiverEmail)}function RedirectMCSave(n,t){var i=!1;return arguments.length==3&&(i=arguments[2]),i||(i=confirm(DecodeHtml(t)+". "+gbl_common_labels.Reports_Alert_OKtocont)),i?(window.location=n,!1):($("#save").hide(),$("#share").hide(),$("#embed").hide(),!1)}function DecodeHtml(n){return n.length>0?n.replace("&#39;","'"):n}function setActiveTab_Main(n,t){$(".toolsList li").removeClass("active");$(n).addClass("active");$(".tab-pane").hide();$(".report-view").show();$(t).show()}function setActiveTab(n,t){$(n).siblings(".radioBtnTabs").removeClass("active");$(n).addClass("active");$(t).siblings(".radioTabContent").hide();$(t).show()}function onNoPreviewSelected(){var t=$("#hdnReportID").val(),n=getCookie("preview");t==""&&n=="Y"&&window.location.href.indexOf("&preview=off")>0&&(setCookie("preview","N"),n=getCookie("preview"));t==""&&n=="N"&&window.location.href.indexOf("&preview=on")<=0&&loadingCounter<1&&($("#databaseLink").length>0?$(".expandPanel:eq(1)").trigger("click"):$(".expandPanel:eq(0)").trigger("click"),listUnselectedVariables(!1),loadingCounter++);n==""&&(window.location.href.indexOf("&preview=off")>0||querySt("country")==null&&querySt("series")==null&&querySt("time")==null&&querySt("topic")==null)&&($("#databaseLink").length>0?$(".expandPanel:eq(1)").trigger("click"):$(".expandPanel:eq(0)").trigger("click"),listUnselectedVariables(!1),loadingCounter++,setCookie("preview","N"));n==""&&(querySt("country")!=null||querySt("series")!=null||querySt("time")!=null||querySt("topic")!=null)&&setCookie("preview","Y");previewSwitch()}function querySt(n){for(hu=window.location.search.substring(1),gy=hu.split("&"),i=0;i<gy.length;i++)if(ft=gy[i].split("="),ft[0]==n)return ft[1]}function listUnselectedVariables(n){var t="";n?($(".selectionModifyTxt").hide(),$(".forDimension").each(function(){var n=eval($(this).text());t+="<li> <span class='dot'><\/span> "+$(this).attr("title").trim()+"<\/li>"})):$(".forDimension").each(function(){var n=eval($(this).text());n=="0"||n==null||n==""?(t+="<li> <span class='dot'><\/span> "+$(this).attr("title").trim()+"<\/li>",$("#divNoDataToDisplay").show(),$("#cbpReportView").hide(),$("#upReportDD").hide(),$("#faded").show()):t+="<li class='selected'> <span class='glyphicon glyphicon-check'><\/span> "+$(this).attr("title").trim()+"<\/li>"});$("#availableDimensions").html(t);n?($(".clearSelTxt").show(),$(".noPreview").hide(),$("#faded").hide()):($(".clearSelTxt").hide(),$("#divNoDataToDisplay").css("display")=="block"&&$(".selectionModifyTxt").hide(),$("#availableDimensions li.selected").length>0&&$("#availableDimensions li.selected").length<$("#availableDimensions li").length?($(".allDimSelected.noPreview").hide(),$(".dimSelected.noPreview").show()):$("#availableDimensions li.selected").length==$("#availableDimensions li").length?($(".allDimSelected.noPreview").show(),$(".dimSelected.noPreview").hide()):$("#availableDimensions li.selected").length==0&&($(".clearSelTxt").show(),$(".noPreview").hide()))}function showHideLangBar(){var n=$("#bannerStrip").outerHeight();$(".language ul li").length>0?($(".language.language-sv").show(),n+=getHeightAlignTop(".language",n)):$(".language.language-sv").hide();n+=getHeightAlignTop(".secondaryHeader",n);n+=getHeightAlignTop("#contentWrapper",n)}function getHeightAlignTop(n,t){return $(n).css({top:t+"px"}),$(n).outerHeight()}function showCountOnTop(){}function previewSwitch(){var t=getCookie("preview"),n;t=="N"?$('#btnDBPreview input[name="previewoption"]:checked').val()!="OFF"&&setPreviewButton(!1):t=="Y"&&($('#btnDBPreview input[name="previewoption"]:checked').val()!="ON"&&setPreviewButton(!0),setCookie("preview","Y"));n=!1;$('#btnDBPreview input[name="previewoption"]').change(function(){var t,i;if(n){n=!1;return}(getCookie("preview")!="Y"||$('#btnDBPreview input[name="previewoption"]:checked').val()!="ON")&&(getCookie("preview")!="N"||$('#btnDBPreview input[name="previewoption"]:checked').val()!="OFF")&&$('#btnDBPreview input[name="previewoption"]:checked').val()!=undefined&&(confirm("If the current report is not saved, please save before proceeding. This will change the database and you may lose your current selections and formatting. Do you wish to proceed?")?($('#btnDBPreview input[name="previewoption"]:checked').val()=="ON"?setCookie("preview","Y"):setCookie("preview","N"),t=$("#tbl_DBList input:checked").parent().attr("source").replace("&","and"),t=t.split("-").join("~").replace(/\s/g,"-").toLowerCase(),i=$("#hdnReportType").val(),window.location.href=$('#btnDBPreview input[name="previewoption"]:checked').val()=="ON"?"reports.aspx?source="+t+"&Type="+i+"&preview=on":"reports.aspx?source="+t):(n=!0,getCookie("preview")=="Y"&&$('#btnDBPreview input[name="previewoption"]:checked').val()!="ON"?window.setTimeout(function(){setPreviewButton(!0);n=!1},100):getCookie("preview")=="N"&&$('#btnDBPreview input[name="previewoption"]:checked').val()!="OFF"&&window.setTimeout(function(){setPreviewButton(!1);n=!1},100)))});$("body").on("click",".main-title-panel",function(){listUnselectedVariables(!1)})}function setPreviewButton(n){n?($('#btnDBPreview input[name="previewoption"][value="ON"]').prop("checked",!0),$('#btnDBPreview input[name="previewoption"][value="ON"]').parent().addClass("active"),$('#btnDBPreview input[name="previewoption"][value="OFF"]').parent().removeClass("active")):($('#btnDBPreview input[name="previewoption"][value="OFF"]').prop("checked",!0),$('#btnDBPreview input[name="previewoption"][value="OFF"]').parent().addClass("active"),$('#btnDBPreview input[name="previewoption"][value="ON"]').parent().removeClass("active"))}function setCookie(n,t,i){var u="",r;i!=null&&(r=new Date,r.setTime(r.getTime()+i*864e5),u="expires="+r.toUTCString());document.cookie=u!=""?n+"="+t+"; "+u:n+"="+t}function getCookie(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}function globalValidateKeyChars(n){var t=n.keyCode?n.keyCode:n.which;return t>=32&&t<=33||t>=35&&t<=57||t>=63&&t<=90||t>=97&&t<=122||t==8||t==61||t==95?!0:!1}function globalValidateKeyChars2(n){var t=n.keyCode?n.keyCode:n.which;return t==32||t==36||t>=40&&t<=41||t>=45&&t<=46||t>=48&&t<=57||t==63||t>=65&&t<=90||t>=97&&t<=122||t==8||t==61||t==95?!0:!1}function globalEvalString(n){return n.search(/[\"\:\;\<\>\[\\\]\^\`\{\|\}\~]+/g)>=0&&(n=n.replace(/[\"\:\;\<\>\[\\\]\^\`\{\|\}\~]+/g,"")),n}function globalEvalString2(n){return n.search(/[\"\:\;\<\>\[\\\]\^\`\{\|\}\~\/\@\#\%\*\&\!\'\+\,]+/g)>=0&&(n=n.replace(/[\"\:\;\<\>\[\\\]\^\`\{\|\}\~\/\@\#\%\*\&\!\'\+\,]+/g,"")),n}function buildComparatorTable(){$("#comparatorReport").hasClass("collapse")&&($("#report-loading").show(),$.ajax({type:"POST",async:!1,url:"reports.aspx/GetModalComparator",contentType:"application/json; charset=utf-8",data:"",dataType:"html",success:function(n){var t=$.parseJSON(n).d;$("#comparatorReport").html(t);showComparatorTable($("#selectComparatorVariables li:first"));$("#selectComparatorVariables li").off("click");$("#selectComparatorVariables li").on("click",function(){showComparatorTable($(this))});$(".comparator-table li input:checkbox").off("click");$(".comparator-table li input:checkbox").on("click",function(n){n.button!=null&&($(".selectionModifyTxt").show(),$("#faded").show(),$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide())});if($("#viewByLbl").length>0){$("#selectCountryDisplay li").off("click");$("#selectCountryDisplay li").on("click",function(){showComparatorTableClassification($(this))});$(".comparator-table.C input").off("click");$(".comparator-table.C input").on("click",function(){var n=$(this).closest("ul").prop("id");$(".comparator-table.C").each(function(){this.id!=n&&$(this).find("input").attr("checked",!1)});$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()})}},error:function(){window.location.href="ddperror.aspx"}}),$("#report-loading").hide())}function showComparatorTable(n){var i=n.find("a").attr("value"),r=n.find("a").attr("value-type"),t;$("#selectedVariable").html(n.find("a").text());$(".comparator-table").hide();$("#tbComparatorVariables_"+i).show();$("#viewByLbl").length>0&&(r=="C"?($("#viewByLbl").show(),$("#viewByDropdown").show(),t=i,$(".comparator-table.C").each(function(){$(this).find("input:checked").length>0&&(t=$(this).attr("value"))}),$("#selectCountryDisplay li[value="+t+"]").trigger("click")):($("#viewByLbl").hide(),$("#viewByDropdown").hide()))}function showComparatorTableClassification(n){var t=n.find("a").attr("value"),i=n.find("a").attr("value-type");$("#selectedViewBy").html(n.find("a").text());$(".comparator-table").hide();$("#tbComparatorVariables_"+t).show()}function inputFocus_DefaultText(n){n.value==n.defaultValue&&(n.value="",n.style.color="#000")}function inputBlur_DefaultText(n){n.value==""&&(n.value=n.defaultValue,n.style.color="#888")}var gbl_download_name="",gbl_download_code="",gbl_download_type="",gbl_selectedTab,loadingCounter=0,gbl_selectedTabOnSwitch="",gbl_clear_selections,gbl_map_zoomdown,gbl_map_splitter_initial;$(function(){initCommon()});gbl_clear_selections=!1;gbl_map_zoomdown=!1;gbl_map_splitter_initial=!1