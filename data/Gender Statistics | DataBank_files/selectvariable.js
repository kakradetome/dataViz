function initSelectVariables(){initMetadataView()}function doAjaxPostbackVariables(n){var i=$("#hdnSelectVars").val().replace(/'/g,"\\'"),t=null;return $.ajax({type:"POST",async:!1,url:gbl_report_methods+"/SetDimensionMembers",contentType:"application/json; charset=utf-8",data:"{reporttype: '"+n+"', dimensiondetails: '"+i+"'}",dataType:"json",success:function(n){t=n.d},error:function(){window.location.href=gbl_error_file}}),t}function onUpdateVarsClick(){var n,t;return hasclearedallselections(!0)?!1:(n=checkvariablelimit(),n)?($(".formatList #liTable,.formatList #liTable a").addClass("disabled"),$(".formatList #liTable,.formatList #liTable a").removeClass("active"),$(".formatList #liChart,.formatList #liChart a").addClass("disabled"),$(".formatList #liMap,.formatList #liMap a").addClass("disabled"),$(".formatList #liMetadata,.formatList #liMetadata a").addClass("disabled"),$("#faded").show(),$(".downloadMsg").show(),$(".selectionModifyTxt").is(":visible")&&$(".selectionModifyTxt").hide(),$("#divNoDataToDisplay").is(":visible")&&$("#divNoDataToDisplay").hide(),!1):($(".formatList #liTable,.formatList #liTable a").removeClass("disabled"),$(".formatList #liChart,.formatList #liChart a").removeClass("disabled"),$(".formatList #liMap,.formatList #liMap a").removeClass("disabled"),$(".formatList #liMetadata,.formatList #liMetadata a").removeClass("disabled"),$("#faded").hide(),$(".downloadMsg").hide(),$("#upReportDD").show(),$("#cbpReportView").show(),$("#divNoDataToDisplay").hide(),t=$.map(gbl_array_member_selected,function(n,t){var u=[],i,r,f;return $("#tbl_sel_"+t+" li").each(function(n,t){u.push($(t).attr("uniqueid"))}),i=null,$("#tbl_"+t).attr("data-type")=="S"&&$("#tb-indicatorAggRule tbody tr").length>0&&$("#lblApplyAll").hasClass("active")&&(i={AggregationMethod:$("#divApplyAll table select.aggrmethod").val(),AggregationPer:$("#divApplyAll table input.txt-percen").val()}),r={},f=$.map(u,function(i){var u=!1;return $("#tbl_"+t).attr("data-type")=="S"&&$("#tb-indicatorAggRule tbody tr").length>0&&$("#lblChooseForAll").hasClass("active")&&(n[i].AggregationRule={AggregationMethod:$('#tb-indicatorAggRule tbody tr[uniqueid="'+i+'"] select.aggrmethod').val(),AggregationPer:$('#tb-indicatorAggRule tbody tr[uniqueid="'+i+'"] input.txt-percen').val()},u=!0),r[i]=n[i],{uniquename:i,displayname:n[i].displayname,iscustom:n[i].custom,customdefinition:n[i].custom?n[i].customdefinition:null,AggregationRule:u?n[i].AggregationRule:null}}),gbl_array_member_selected_clone[t]=jQuery.extend(!0,{},r),{controlid:t,memberdetails:f,aggregationruleall:i}}),$("#hdnSelectVars").val(JSON.stringify(t)),$("#hdnReportType").val()=="METADATA")?getSelectedMetaAttribs():!0}function updatevariablesfordownload(){var n=$.map(gbl_array_member_selected,function(n,t){var r=[],i,u;return $("#tbl_sel_"+t+" li").each(function(n,t){r.push($(t).attr("uniqueid"))}),i=null,$("#tbl_"+t).attr("data-type")=="S"&&$("#tb-indicatorAggRule tbody tr").length>0&&$("#lblApplyAll").hasClass("active")&&(i={AggregationMethod:$("#divApplyAll table select.aggrmethod").val(),AggregationPer:$("#divApplyAll table input.txt-percen").val()}),u=$.map(r,function(i){var r=!1;return $("#tbl_"+t).attr("data-type")=="S"&&$("#tb-indicatorAggRule tbody tr").length>0&&$("#lblChooseForAll").hasClass("active")&&(n[i].AggregationRule={AggregationMethod:$('#tb-indicatorAggRule tbody tr[uniqueid="'+i+'"] select.aggrmethod').val(),AggregationPer:$('#tb-indicatorAggRule tbody tr[uniqueid="'+i+'"] input.txt-percen').val()},r=!0),{uniquename:i,displayname:n[i].displayname,iscustom:n[i].custom,customdefinition:n[i].custom?n[i].customdefinition:null,AggregationRule:r?n[i].AggregationRule:null}}),{controlid:t,memberdetails:u,aggregationruleall:i}});$("#hdnSelectVars").val(JSON.stringify(n));setSelectedVariables()}function setSelectedVariables(){var n="";return $.ajax({type:"POST",async:!1,url:gbl_select_variables_url,cache:!1,data:$("#hdnSelectVars").serialize(),success:function(t){n=t},error:function(t){n=t.responseText}}),n}function checkvariablelimit(){var n=1;return $(".selectionCount").each(function(t,i){var r=$(i).parents(".panel").find(".selectedView").attr("id");($(i).parents(".panel").attr("id")=="zoomModalHeader"&&(n=parseInt(n*i.textContent||i.innerText)),r!=null)&&(r=r.replace("tbl_sel_",""),r!="MetaAttr"&&r!="DBList")&&(n=parseInt(n*i.textContent||i.innerText))}),n>gbl_report_Cell_Limit?(!gbl_common_internal&&n>gbl_download_Cell_Limit?($(".downloadMsg").text(gbl_msg_report_Download_Limit.replace("__",n)),isdownloadlimit=!0,$(".downloadMsg").removeClass("topRightDisplay")):($(".downloadMsg").text(gbl_msg_report_Cell_Limit.replace("__",n)),$(".downloadMsg").addClass("topRightDisplay")),!0):!1}function loadAvailableList(n,t,i){var r=$(i).parents(".panel-heading").find(".panel-title a")[0];loadDimensionList(n,t,r)}function loadSelectedList(n,t,i){var r=$(i).parents(".panel-heading").find(".panel-title a")[0];loadDimensionList(n,t,r)}function loadDimensionList(n,t,i){var r,u;if(i!=null&&!$(i).hasClass("collapsed")&&!$(i).hasClass("addMoreRHS")){$(i).parents(".panel-heading").find(".toggleSelectionViews a").removeClass("active");return}$("#report-loading").show();r=gbl_array_data[n+"_"+t];r==null?(gbl_array_data[n+"_"+t]="Loading",u=new Date,$.ajax({type:"POST",async:!0,url:gbl_report_methods+"/GetDimensionJSON",contentType:"application/json; charset=utf-8",data:"{cubeid: '"+$("#hdnCubeID").val()+"', controlid: '"+n+"', hierarchy: '"+t+"'}",dataType:"json",success:function(i){gbl_array_data[n+"_"+t]=i.d;createDimensionList(n,t,!0);$("#report-loading").hide();initDragDrop()},error:function(){gbl_array_data[n+"_"+t]=null;$("#report-loading").hide();window.location.href=gbl_error_file}})):(i==null&&createDimensionList(n,t,!0),$("#report-loading").hide())}function createDimensionList(n,t,i){var u="#tbl_"+n,r=gbl_array_data[n+"_"+t],f,e;r!=null&&(gbl_array_member_selected[n]==null&&(gbl_array_member_selected[n]=r.Sel,gbl_array_member_selected_clone[n]=jQuery.extend(!0,{},r.Sel)),initFilter(n,t,u,i,r),r.CL&&r.Levels!=null&&r.CHL.length>0?loadClassificationFilter(n,t,u,i,r.CHL):loadFilter(n,t,u,i,r.Levels),r.CL?(f=$.merge($.merge([],r.Members),r.Aggr),e=$.merge($.merge([],r.JTL),r.JTLA),loadDimMembers(n,u,i,f,e,!1),sortAllSelectedItems($("#tbl_"+n),!0)):loadDimMembers(n,u,i,r.Members,r.JTL,!1),getSelectedMembers(n,u))}function loadDimMembers(n,t,i,r,u,f){var e,s,o;if(r==null){alert("Failed to load members. Either session expired or unable to process the database. Please contact the administrator.");return}f||(gbl_array_member_list[n]=r,$(t).parents(".panel").find(".searchResults").hide());e=gbl_array_member_selected[n];e==null&&(e={});s=n=="DBList";$("#ulJumpToList_"+n).html("");u!=null&&$.each(u,function(t,i){$("#ulJumpToList_"+n).append('<li class="jumpTo"><a href="javascript:void(0)">'+i+"<\/a><\/li>")});gbl_display_list[n]=r;o=$(t).attr("data-type");o=="T"?(stringBuilder_Time(n,t,i,gbl_display_list[n]),timeDimArray=gbl_display_list[n],initSlider(1,timeDimArray.length),createPagerDropdown(n,timeDimArray)):(stringBuilder(n,t,i,gbl_display_list[n]),createPagerDropdown(n,gbl_display_list[n]))}function initPagination(){$("body").on("click",".showNext",function(){var n=$(this).attr("data-source"),i=$(this).attr("target-id"),r=$(this).attr("data-input"),u=eval($(this).attr("metadata")),f=eval($(this).attr("custom-option")),t;gbl_start_var=gbl_end_var;gbl_end_var=gbl_end_var+threshold;stringBuilder(n,i,!1,gbl_display_list[n]);t=eval($("#goTo_"+n).val())+1;$(".goTo").val(t)});$("body").on("click",".showPrev",function(){var n=$(this).attr("data-source"),i=$(this).attr("target-id"),r=$(this).attr("data-input"),u=eval($(this).attr("metadata")),f=eval($(this).attr("custom-option")),t;gbl_start_var=gbl_start_var-threshold;gbl_end_var=gbl_start_var+threshold;stringBuilder(n,i,!1,gbl_display_list[n]);t=eval($("#goTo_"+n).val())-1;$(".goTo").val(t)});$("body").on("click",".showNext_Time",function(){var n=$(this).attr("data-source"),t=$(this).attr("target-id"),r=$(this).attr("data-input"),u=eval($(this).attr("metadata")),f=eval($(this).attr("custom-option")),i;gbl_start_var_time=gbl_end_var_time;gbl_end_var_time=gbl_end_var_time+threshold;stringBuilder_Time(n,t,!1,timeDimArray);i=eval($("#goTo_"+n).val())+1});$("body").on("click",".showPrev_Time",function(){var n=$(this).attr("data-source"),i=$(this).attr("target-id"),r=$(this).attr("data-input"),u=eval($(this).attr("metadata")),f=eval($(this).attr("custom-option")),t;gbl_start_var_time=gbl_start_var_time-threshold;gbl_end_var_time=gbl_start_var_time+threshold;stringBuilder_Time(n,i,!1,timeDimArray);t=eval($("#goTo_"+n).val())-1;$(".goTo").val(t)});$("body").on("click",".range",function(){$(this).parents(".panel").find(".unselectAll").trigger("click");$(".selectedDimensionTime  .searchResults ").show();var n=$(this).attr("data-source"),i=$(this).attr("target-id"),r=eval($(this).attr("data-range")),t=gbl_array_member_list[n].slice(0,r);timeDimArray=t;stringBuilder_Time(n,i,!1,t);initSlider(1,timeDimArray.length);setTimeout(function(){$("#slider-range").parents(".panel").find(".selectAll").trigger("click")},10)});$("body").on("change",".goTo",function(){var t=eval($(this).val()),n=$(this).attr("data-source"),i=$(this).attr("target-id"),r=n.split("_")[1];r=="Time"?(gbl_start_var_time=t*threshold-threshold,gbl_end_var_time=t*threshold,timeDimArray=gbl_display_list[n],stringBuilder_Time(n,i,!1,timeDimArray),initSlider(1,timeDimArray.length)):(gbl_start_var=t*threshold-threshold,gbl_end_var=t*threshold,stringBuilder(n,i,!1,gbl_display_list[n]))});$(".availableCount").off("click");$(".availableCount").on("click",function(){$(this).parents(".toggleSelectionViews").find(".showAvailable").trigger("click")});$(".selectionCount").off("click");$(".selectionCount").on("click",function(){$(this).parents(".toggleSelectionViews").find(".showSelected").trigger("click")})}function stringBuilder(n,t,i,r){var u=0,f=0,h={dataType:"json",dataFields:[{name:"ID",type:"string"},{name:"Code",type:"string"},{name:"Name",type:"string"},{name:"JTC",type:"string"},{name:"SM",type:"boolean"}],localdata:r},e=gbl_array_member_selected[n],s,o;e==null&&(e={});s=n=="DBList";o=new $.jqx.dataAdapter(h,{loadComplete:function(r){var r=o.records,c=r.length,d="",g="",p="",v=$(t).attr("data-type"),a=[],y,k;if(c>0){if(c<threshold?(u=0,f=c,$("#selectedDimension_"+n+" .customPagination").hide()):(u=gbl_start_var,f=gbl_end_var,$("#selectedDimension_"+n+" .customPagination").show(),$("#selectedDimension_"+n+" .totalCount").text(c),gbl_start_var<=1?($("#selectedDimension_"+n+" .showPrev").attr("disabled","disabled"),u=0):$("#selectedDimension_"+n+" .showPrev").attr("disabled",!1),gbl_end_var<c?$("#selectedDimension_"+n+" .showNext").attr("disabled",!1):(gbl_end_var=c,$("#selectedDimension_"+n+" .showNext").attr("disabled","disabled"),f=c)),$("#selectedDimension_"+n+" .start").text(u+1),$("#selectedDimension_"+n+" .end").text(f),v!="T"){for(y=u;y<f;y++){var h=r[y],nt=h.JTC,tt=e[h.ID]!=null,w="",b="",l="";tt&&(w="class='selected'",b="checked='checked'");s?(l="<li alphabet= '"+nt+"' "+w+" uniqueId='"+h.ID+"' source='"+h.Name+"'>",l+="<a  href='#dbMetadata' data-toggle='modal' data-target='#dbMetadata'><span title='View Metadata' class='metadataIcon1 sprite icon-info' data-value-code='"+h.ID+"'><\/span><\/a>",l+="<input name='databaseName' type='radio' id='radio"+h.ID+"' class='radioSelectElement' "+b+"/>"):(l="<li alphabet= '"+nt+"' "+w+" uniqueId='"+h.ID.replace(/\'/g,"%27")+"'>",l+=h.SM?"<a href='#divMetadataCtl' data-toggle='modal' data-target='#divMetadataCtl'><span title='View Metadata' class='metadataIcon sprite icon-info' data-value-code='"+h.Code+"'><\/span><\/a>":"<span class='spacer' style='width:16px;height:16px; display:inline-block; float:left'><\/span>",i&&(l+="<span class='glyphicon glyphicon-plus-sign plusIcon' title='Add to Custom Group'> <\/span> "),l+="<input type='checkbox' id='chk"+h.ID+"' class='chkSelectElement' "+b+"/>");l+="<span class='value bookunit' >"+h.Name+"<\/span>";l+="<\/li>";d+=l;a=a+h.JTC+",";v=="T"&&(k='<option value="'+h.ID+'">'+h.Name+"<\/option>",g+=k,p=k+p)}$(t).html(d);gbl_SubnationalFilter&&v=="C"&&($("#searchBox_"+n).val()==""||gbl_remove_search)&&($(t).find("li").each(function(){var n=$(this).attr("uniqueid").split("&").pop();n.indexOf("_")>0?$(this).addClass("subnational"):($(this).addClass("national"),$(this).wrapInner("<div class='nationalName'><\/div>"),$(this).prepend("<div class='nationalHeader'><span class='closed caret-n' title='Click here to view subnationals'><\/span> "+$(this).find(".value").text()+"<div class='btn-group pull-right'><a class='btn selectAllSub btn-default' title='Select all subnationals'><span class='glyphicon  glyphicon-check'><\/span><\/a> <a class='btn unselectAllSub btn-default' title='Unselect all subnationals'><span class='glyphicon glyphicon-remove'><\/span><\/a><\/div><\/div>"))}),$(".national").each(function(){var n=$(this).attr("uniqueid").split("&").pop();n=n.substring(1,n.length-1);$(this).attr("parent",n);$(".subnational").each(function(){var t=$(this).attr("uniqueid").split("&").pop();t.indexOf(n)>0&&$(this).attr("child",n)});$(this).siblings("li[child='"+n+"']").length<1&&($(this).find(".closed").addClass("disabled"),$(this).find(".nationalName").show(),gbl_common_culture=="ar"?$(this).find(".nationalName").css("margin-right","0"):$(this).find(".nationalName").css("margin-left","0"),$(this).find(".nationalName").css("font-weight","bold"),$(this).find(".nationalName").prepend("<span class='closed disabled caret-n'><\/span>"),$(this).find(".nationalHeader").hide())}));a=a.split(",");a=unique(a);$("#ulJumpToList_"+n).html("");$.each(a,function(t,i){$("#ulJumpToList_"+n).append('<li class="jumpTo"><a href="javascript:void(0)">'+i+"<\/a><\/li>")});$(t).parents(".panel").hasClass("modal-body")?$(t).parents(".modal-content").find(".availableCount").text(c):$(t).parents(".panel").find(".availableCount").text(c);v=="T"&&($("#selCustomTime_From").html(p),$("#selCustomTime_To").html(g))}}else c==0&&($(t).html("<div class='noRecords'>No Records<\/div>"),$(t).parents(".panel").find(".availableCount").text("0"));gbl_array_member_selected[n]=e;$(".metadataIcon").on("click",function(){var n=$(this).attr("data-value-code"),t=$(this).closest("li").find("span.value").text(),i=$(this).closest("ul").attr("data-type"),r=$(this).closest("ul").attr("data-text");loadMetaDataVariable(t,n,i,r)});$(".metadataIcon1").on("click",function(){var n=$(this).attr("data-value-code");loadDatabaseDetails(n)});$(".bookunit").mouseover(function(){var i=$(this).closest("ul").attr("data-type"),t,n;i=="S"&&gbl_HasIndicatorUnit&&(t=$(this).closest("li").attr("uniqueid"),n=$.grep(gbl_array_book_attributes,function(n){return n.seriesId==t}),n!=null&&n.length>0&&(strBookUnitName=n[0].bookUnit,$(this).attr("title",strBookUnitName)))})},loadError:function(){},beforeLoadComplete:function(){},afterLoadComplete:function(){}});o.dataBind()}function unique(n){return $.grep(n,function(t,i){return i==$.inArray(t,n)})}function stringBuilder_Time(n,t,i,r){var u=0,f=0,s={dataType:"json",dataFields:[{name:"ID",type:"string"},{name:"Code",type:"string"},{name:"Name",type:"string"},{name:"JTC",type:"string"},{name:"SM",type:"boolean"}],localdata:r},e=gbl_array_member_selected[n],o;e==null&&(e={});o=new $.jqx.dataAdapter(s,{loadComplete:function(i){var i=o.records,r=i.length,b="",a="",it=$(t).attr("data-type"),h="",l="",v,y,p,c,w,g,nt;if(r>0){for(r<threshold?(u=0,f=r,l=r/4,$("#selectedDimension_"+n+" .customPagination").hide(),timePaging=!1):(l=threshold/4,u=gbl_start_var_time,f=gbl_end_var_time,$("#selectedDimension_"+n+" .customPagination").show(),timePaging=!0,$("#selectedDimension_"+n+" .totalCount").text(r),gbl_start_var_time<=1?($("#selectedDimension_"+n+" .showPrev_Time").attr("disabled","disabled"),u=0):$("#selectedDimension_"+n+" .showPrev_Time").attr("disabled",!1),gbl_end_var_time<r?$("#selectedDimension_"+n+" .showNext_Time").attr("disabled",!1):(gbl_end_var_time=r,$("#selectedDimension_"+n+" .showNext_Time").attr("disabled","disabled"),f=r,l=(f-u)/4)),$("#selectedDimension_"+n+" .start").text(u+1),$("#selectedDimension_"+n+" .end").text(f),liCounter=u,v=0,y=v;y<4;y++){for(h=h+"<ul class='colUl'>",p=0;p<l;p++)if(liCounter<f){var s=i[liCounter],rt=s.JTC,tt=e[s.ID]!=null,k="",d="";tt&&(k="class='selected'",d="checked='checked'");c="<li alphabet= '' "+k+" uniqueId='"+s.ID+"'>";c+="<input type='checkbox' id='chk"+s.ID+"' class='chkSelectElement' "+d+"/>";c+="<span class='value'>"+s.Name+"<\/span>";c+="<\/li>";h+=c;w='<option value="'+s.ID+'">'+s.Name+"<\/option>";b+=w;a=w+a;liCounter++}g=i[0].Name;nt=i[r-1].Name;$("#year").text(nt+" - "+g);h=h+"<\/ul>";v++}$(t).html(h);$("#selCustomTime_From").html(a);$("#selCustomTime_To").html(b);$(t).parents(".panel").hasClass("modal-body")?$(t).parents(".modal-content").find(".availableCount").text(r):$(t).parents(".panel").find(".availableCount").text(r)}else r==0&&$(t).html("<div class='noRecords'>No Records<\/div>");gbl_array_member_selected[n]=e},loadError:function(){},beforeLoadComplete:function(){},afterLoadComplete:function(){}});o.dataBind()}function getSelectedMembers(n,t){var r=gbl_array_member_selected[n],i,u;r!=null&&(i="",u=$(t).parent().find(".selectedView").attr("data-type"),$.each(r,function(r,f){var e="",o=!1,s="Add to Custom Group";switch(u){case"C":e="editCustomGroup";break;case"S":o=!0;s="Add to Custom Indicator";e="editCustomIndicator";break;case"T":e="editCustomPeriod"}$(t).parent().find(".selectedView").find('li[uniqueid="'+r+'"]').length<=0&&(i+=f.custom?addCustomMember(n,t,f,!1,e,o,""):"<li class='selected' uniqueId='"+r+"'><span class='glyphicon glyphicon-plus-sign plusIcon' title='"+s+"'> <\/span><span class='deleteIcon glyphicon glyphicon-remove-circle' title='Remove from selection'><\/span><span class='value'>"+f.displayname+"<\/span><\/li>")}),$(t).parent().find(".selectedView li").each(function(n,i){var u=$(i).attr("uniqueid");r[u]==null&&$(t).parent().find('.selectedView li[uniqueid="'+u+'"]').remove()}),getSelectedCount(n,t),$(t).parent().find(".selectedView").append(i),u=="T"&&$("#ascendingChkBox").prop("checked")&&(myhelper=function(n){return $("span",$(n)).text()},sortTimeAscending($(t).parent().find(".selectedView"))))}function getSelectedCount(n,t){var u=gbl_array_member_selected[n],i=Object.keys(u).length,r;i>0?$(t).parents(".panel").find(".noVariableTxt").hide():$(t).parents(".panel").find(".noVariableTxt").show();$(t).parents(".panel").hasClass("modal-body")?$(t).parents(".modal-content").find(".selectionCount").text(i):$(t).parents(".panel").find(".selectionCount").text(i);r="#"+n+"_selectCountRHS";$(r).text(i)}function setSelectionChange(n){var t=$(n).prop("checked");setSelectionChangeEx(n,t,".availableView")}function setSelectionChangeEx(n,t,i){var r=$(n).parents(".panel").find(i).attr("data-value"),l="#tbl_"+r,o=$(n).parents(".panel").find(i).attr("data-type"),u=gbl_array_member_selected[r],f,s,e,a,h,c;u==null&&(u={});f=$(n).parent("li").attr("uniqueid");s=$(n).parent("li").find(".value").text();gbl_SubnationalFilter&&o=="C"&&f==null&&(f=$(n).parent("div").parent("li").attr("uniqueid"),s=$(n).parent("div").parent("li").find(".value").text());o!="S"||$("#aggRuleTxt div.panel-heading a").hasClass("collapsed")||$("#aggRuleTxt div.panel-heading a").trigger("click");t&&u[f]==null?u[f]={displayname:s,custom:!1}:t||u[f]==null||(e=u[f],e.customdefinition!=null&&e.customdefinition.periods!=null&&e.customdefinition.periods.length>0&&($tblavailable=$("#tbl_"+r),$.each(e.customdefinition.periods,function(n,t){$tblavailable.find("input[id='chk"+t.uniquename+"']").prop({checked:!1}).removeAttr("disabled")})),delete u[f]);gbl_array_member_selected[r]=u;getSelectedMembers(r,l);$("#divNoDataToDisplay").is(":hidden")?($("#faded").show(),a=$("#panel_"+r).position(),$(".selectionModifyTxt").show(),$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide(),$(".selectionModifyTxt").attr("panel-id","#panel_"+r)):(h=0,$(".selectionCountRHS").each(function(){var n=eval($(this).text());(n==null||n<1||n=="")&&h++}),h>0?$("#applyChangesNoPreview").addClass("disabled"):($("#applyChangesNoPreview").removeClass("disabled"),$(".allDimSelected.noPreview").show(),$(".dimSelected.noPreview").hide()));o=="S"&&$("#hdnReportType").val()=="CHART"&&gbl_HasIndicatorUnit&&(c=!1,r=$('.variableTable.selectedView[data-type="S"]').attr("data-value"),$(".page-ddl").attr("id")!=null&&$(".page-ddl").attr("id").indexOf(r)>=0&&(c=!0),validateBookUnits()||c||(document.getElementById("selModifyText").innerHTML=gbl_common_labels.Reports_Label_Selection_UnitModified))}function removecustomvariables(n){var i=$(n).parents(".panel").find(".availableView").attr("data-value"),t=gbl_array_member_selected[i];t==null&&(t={});$(n).parents(".panel").find(".selectedView li").each(function(n,i){var r=$(i).attr("uniqueid");r.indexOf("custom_")>=0&&delete t[r]});gbl_array_member_selected[i]=t}function setSelections(n){var i=$(n).parents(".panel").find(".availableView").attr("data-value"),u="#tbl_"+i,t=gbl_array_member_selected[i],f,r;t==null&&(t={});$(n).parents(".panel").find(".availableView li").each(function(n,i){var r=$(i).attr("uniqueid"),f=$(i).find(".value").text(),u=$(i).find(".chkSelectElement").prop("checked");u&&t[r]==null&&(t[r]={displayname:f,custom:!1});u||t[r]==null||delete t[r]});gbl_array_member_selected[i]=t;getSelectedMembers(i,u);$("#divNoDataToDisplay").is(":hidden")?($("#faded").show(),f=$("#panel_"+i).position(),$(".selectionModifyTxt").show(),$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide(),$(".selectionModifyTxt").attr("panel-id","#panel_"+i)):(r=0,$(".selectionCountRHS").each(function(){var n=eval($(this).text());(n==null||n<1||n=="")&&r++}),r>0?$("#applyChangesNoPreview").addClass("disabled"):($("#applyChangesNoPreview").removeClass("disabled"),$(".allDimSelected.noPreview").show(),$(".dimSelected.noPreview").hide()));$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}function initFilter(n,t,i,r,u){if(u.CL)initClassificationFilter(n,t,i,r,u),$("#tbl_"+n).attr("data-type")=="C"&&($("#showCountryAggOption_"+n).hide(),$("#CtryAgg_Classification_"+n).show());else{$("#tbl_"+n).attr("data-type")=="C"&&($("#showCountryAggOption_"+n).show(),$("#CtryAgg_Classification_"+n).hide());$(".dimension-hierarchy-"+n+" option").length<=0&&(u.Hier!=null&&Object.keys(u.Hier).length>0?($.each(u.Hier,function(t,i){$(".dimension-hierarchy-"+n).append('<option value="'+t+'">'+i+"<\/option>")}),$(".dimension-hierarchy-"+n).val(u.DH)):$(".dimension-hierarchy-"+n).append('<option value="'+u.DH+'">'+u.DH+"<\/option>"));$(".dimension-hierarchy-"+n+" option").length<=1&&$("#hierarchy_"+n).hide();$(".dimension-hierarchy-"+n).off("change");$(".dimension-hierarchy-"+n).on("change",function(){loadDimensionList(n,$(this).val(),null);$(".showCountryAggOption").removeClass("active");$(".showCountryAggOption[data-value='All']").addClass("active")})}}function loadFilter(n,t,i,r,u){var f="",e=n=="DBList";if(u!=null){$.each(u,function(n,t){f+=getFilterList(n,t,e)});$("#tbl_"+n).attr("data-type")=="C"&&f.indexOf("filter-check-aggregates")<1&&($("#showCountryAggOption_"+n).hide(),$("#CtryAgg_Classification_"+n).hide());$("#lstFilterItems_"+n).html(f);setTimeout(function(){$("#lstFilterItems_"+n).find("li.show").length==0&&$("#lstFilterItems_"+n).prepend("<em>This hierarchy has no sub-levels.<\/em>")},100);$(".filter-check").on("click",function(){var h,c;$("#report-loading").show();var u=$("#lstFilterItems_"+n+" .filter-check:checked").map(function(n,t){return{datavalue:$(t).attr("data-value"),datalevel:$(t).attr("data-level")}}).toArray(),o=gbl_array_data[n+"_"+t],s=o.Members,f=o.JTL;u.length>0&&(h=o.Members,c=$(i).attr("data-type"),s=gbl_SubnationalFilter&&c=="C"?$.grep(h,function(n){return getSubnationalFilterSelected(u,n,e)}):$.grep(h,function(n){return getFilterSelected(u,n,e)}),f=$(s).map(function(n,t){return t.JTC}),f=$.unique(f));loadDimMembers(n,i,r,s,f,!1);$("#report-loading").hide();$(".nonclassification").is(":visible")&&($(".showCountryAggOption").removeClass("active"),$(".showCountryAggOption[data-value='Countries']").addClass("active"));$(this).parents(".panel").find(".searchInput").val("");u.length>0?$(this).parents(".panel").find(".filterResults").show():$(this).parents(".panel").find(".filterResults").hide()})}}function getSubnationalFilterSelected(n,t,i){for(var r=0;r<n.length;r++)if(i){if(t.HLS!=null&&t.HLS.indexOf(n[r].datavalue)>=0)return!0}else if(t.HLS!=null&&t.HLS[n[r].datalevel-1]==n[r].datavalue||n[r].datavalue.split("&").pop().replace("[","").replace("]","")==t.Name||t.HLS.length==1&&n[r].datalevel==1)return!0}function filterCountryAggregates(){$("body").on("click",".showCountryAggOption",function(){var n=$(this).attr("controlId"),i=$(this).attr("data-value"),r=$("#ddlDimHierarchy_"+n).val(),t=$("#lstFilterItems_"+n);i=="All"?($("#toggleFilter_"+n).attr("disabled",!1),$("#_filterTree_"+n).removeClass("disabled"),t.find(".filter-check").prop("checked",!1),t.find(".filter-check").trigger("click"),setTimeout(function(){t.find(".filter-check").prop("checked",!1)},100)):i=="Countries"?($("#toggleFilter_"+n).attr("disabled",!1),$("#_filterTree_"+n).removeClass("disabled"),t.find(".filter-check").prop("checked",!1),t.find(".filter-check").trigger("click"),$(".filter-check-aggregates .filter-check").trigger("click"),setTimeout(function(){t.find(".filter-check").prop("checked",!1)},100)):($("#_filterTree_"+n).addClass("disabled"),$("#toggleFilter_"+n).attr("disabled",!0),t.find(".filter-check").prop("checked",!0),t.find(".filter-check").trigger("click"),$(".filter-check-aggregates .filter-check").trigger("click"),setTimeout(function(){t.find(".filter-check").prop("checked",!1)},100));$("#filterResults_"+n).hide()})}function getFilterSelected(n,t,i){for(var r=0;r<n.length;r++)if(i){if(t.HLS!=null&&t.HLS.indexOf(n[r].datavalue)>=0)return!0}else if(t.HLS!=null&&t.HLS[n[r].datalevel-1]==n[r].datavalue)return!0}function getFilterList(n,t,i){var r=""+(t.HID.indexOf("[Aggregates]")>0?'<li class="dispNone filter-check-aggregates">':t.HID.indexOf("[Countries]")>0?'<li class="dispNone filter-check-countries">':'<li class="show">');switch(t.LN){case 1:r+='<div class="parentNode">';t.LV.length>0&&(r+="<span class='toggleList'><\/span>");i||(r+='<input type="checkbox" class="masterSelector filter-check" data-value="'+t.HID+'" data-level="'+t.LN+'" />');r+="<span class='toggleListText'>"+t.HN+"<span><\/div>";break;default:r+='<input type="checkbox" class="selector filter-check" data-value="'+t.HID+'" data-level="'+t.LN+'" />'+t.HN}return t.LV.length>0&&(r+='<ul class="childNodes level'+t.LN+'">',$.each(t.LV,function(n,t){r+=getFilterList(n,t,i)}),r+="<\/ul>"),r+="<\/li>"}function loadSelectFilterItems(n){var r=$("#divMapRegion .select-filter-check:checked, #divMapIncome .select-filter-check:checked").map(function(n,t){return{datavalue:$(t).attr("value"),filtertype:$(t).attr("filter-type")}}).toArray(),t=$("#divMapRegion").attr("data-type"),u=$.grep(Object.keys(gbl_array_data),function(n){if(n.indexOf(t+"_")==0)return!0}),f=u.length>0?gbl_array_data[u[0]]:null,i;if(r.length>0&&f!=null){i=f.Members;i=$.grep(i,function(n){return getSelectFilterSelected(r,n)});$(n).parents(".panel").find(".selectedView li").remove();$(n).parents(".panel").find(".availableView li .chkSelectElement").prop("checked",!1);$(n).parents(".panel").find(".availableView li").removeClass("selected");var t=$(n).parents(".panel").find(".selectedView").attr("data-value"),s="#tbl_"+t,e={},o="";$.each(i,function(t,i){e[i.ID]={displayname:i.Name,custom:!1};o+="<li class='selected' uniqueId='"+i.ID+"'><span class='glyphicon glyphicon-plus-sign plusIcon' title=''> <\/span><span class='deleteIcon glyphicon glyphicon-remove-circle' title='Remove from selection'><\/span><span class='value'>"+i.Name+"<\/span><\/li>";$(n).parents(".panel").find(".availableView li[uniqueid='"+i.ID+"']").addClass("selected").find(".chkSelectElement").prop("checked",!0)});$(n).parents(".panel").find(".selectedView").append(o);gbl_array_member_selected[t]=e;getSelectedMembers(t,s)}}function getSelectFilterSelected(n,t){for(var r,i=0;i<n.length;i++)if(r=n[i].filtertype=="Region"?0:n[i].filtertype=="Income"?1:-1,r>=0&&t.HLS!=null&&t.HLS[r]==n[i].datavalue)return!0}function initClassificationFilter(n,t,i,r,u){$(".dimension-hierarchy-"+n+" option").length<=0&&$.each(u.Levels,function(t,i){$(".dimension-hierarchy-"+n).append('<option value="'+i.HID+'">'+i.HN+"<\/option>")});$("#hierarchy_"+n).hide();$(".CtryAgg_Classification").click(function(){var f=$(this).attr("data-value"),s=$("#lstFilterItems_"+n),e,o;f=="All"?(e=$.merge($.merge([],u.Members),u.Aggr),o=$.merge($.merge([],u.JTL),u.JTLA),loadDimMembers(n,i,r,e,o,!1),getSelectedMembers(n,i),u.Levels!=null&&u.CHL.length>0&&loadClassificationFilter(n,t,i,r,u.CHL),$("#toggleFilter_"+n).attr("disabled",!1),sortAllSelectedItems($("#tbl_"+n),!0),$("#_filterTree_"+n).removeClass("disabled")):f=="Countries"?(loadDimMembers(n,i,r,u.Members,u.JTL,!1),getSelectedMembers(n,i),u.Levels!=null&&u.CHL.length>0&&loadClassificationFilter(n,t,i,r,u.CHL),$("#toggleFilter_"+n).attr("disabled",!1),$("#_filterTree_"+n).removeClass("disabled")):(loadDimMembers(n,i,r,u.Aggr,u.JTLA,!1),getSelectedMembers(n,i),u.Levels!=null&&u.CHL.length>0&&loadClassificationFilter(n,t,i,r,u.CHL),$("#toggleFilter_"+n).attr("disabled",!0),$("#_filterTree_"+n).addClass("disabled"));$("#filterResults_"+n).hide();$("#hierarchy_"+n).hide()})}function loadClassificationFilter(n,t,i,r,u){var f="";$.each(u,function(n,t){f+=getClassificationFilterList(n,t)});$("#lstFilterItems_"+n).html(f);$(".filter-check").on("click",function(){var s;$("#report-loading").show();var f=$("#lstFilterItems_"+n+" .filter-check:checked").map(function(n,t){return{datavalue:$(t).attr("data-value"),datalevel:$(t).attr("data-level"),parentindex:$(t).parent().parent().closest("li").attr("data-index")}}).toArray(),e=gbl_array_data[n+"_"+t],o=e.Members,u=e.JTL;f.length>0&&(s=e.Members,o=$.grep(s,function(n){return getClassificationSelected(f,n)}),u=$(o).map(function(n,t){return t.JTC}),u=$.unique(u));loadDimMembers(n,i,r,o,u,!1);$("#report-loading").hide();$(this).parents(".panel").find(".searchInput").val("");$(this).parents(".panel").find(".searchResults").hide();f.length>0?$(this).parents(".panel").find(".filterResults").show():$(this).parents(".panel").find(".filterResults").hide();$(".classification").is(":visible")&&($(".CtryAgg_Classification").removeClass("active"),$(".CtryAgg_Classification[data-value='Countries']").addClass("active"))})}function getClassificationSelected(n,t){for(var r=!0,u=[],f=[],e=[],o=!1,s=!1,h=!1,i=0;i<n.length;i++)n[i].parentindex==0?(e.push(n[i].datavalue),s=!0):n[i].parentindex==1?(u.push(n[i].datavalue),o=!0):n[i].parentindex==2&&(f.push(n[i].datavalue),h=!0);return r&&s&&(r=$.grep(t.HLS,function(n){return $.inArray(n,e)!=-1}).length>0?!0:!1),r&&o&&(r=$.grep(t.HLS,function(n){return $.inArray(n,u)!=-1}).length>0?!0:!1),r&&h&&(r=$.grep(t.HLS,function(n){return $.inArray(n,f)!=-1}).length>0?!0:!1),r}function getClassificationFilterList(n,t){var i=""+('<li data-index="'+n+'">');switch(t.LN){case 1:i+='<div class="parentNode">';i+="<span class='toggleList mT4'><\/span>";i+="<span class='toggleListText'>"+t.HN+"<span><\/div>";break;default:i+='<input type="checkbox" class="selector filter-check" data-value="'+t.HID+'" data-level="'+t.LN+'" /> '+t.HN}return t.LV.length>0&&(i+='<ul class="childNodes level'+t.LN+'">',$.each(t.LV,function(n,t){i+=getClassificationFilterList(n,t)}),i+="<\/ul>"),i+="<\/li>"}function initSearch(){$(".searchBtn").click(function(){var t=$(this).attr("data-source"),r=gbl_array_member_list[t],u=$(this).attr("target-id"),f=$(this).attr("data-input"),o=eval($(this).attr("metadata")),s=eval($(this).attr("custom-option")),i;if(invokeSearch(t,f,r,u,!0),typeof s_account!="undefined"&&s_account!=null&&$(this).siblings(".searchInput").val()!=null&&$(this).siblings(".searchInput").val()!=""){var e=$(this).parents(".panel").find(".availableView").attr("data-type"),h=$(".database h2").text().trim(),n="";switch(e){case"T":n="Year";break;case"S":n="Series";break;case"C":n="Country";break;case"D":n="Database";break;case"O":n=$(this).parents(".panel").find(".main-title-panel").text().trim();break;default:n="GeneralQuery"}i=s_prop1;s_linkType="l";s_prop1=$(".database h2").text().trim()+">"+n+">Search";s_linkName=$(".database h2").text().trim()+">"+n+">Search> "+$(this).siblings(".searchInput").val();s_lnk=s_co(window.location);s_gs(s_account);s_prop1=i}});$(".removeSearch").click(function(){gbl_start_var=1;gbl_end_var=threshold;var n=$(this).attr("data-source"),i=gbl_array_member_list[n],u=$(this).attr("destination_type"),r=$(this).attr("target-id"),f=eval($(this).attr("metadata")),e=eval($(this).attr("custom-option")),t=$(i).map(function(n,t){return t.JTC});t=$.unique(t);u=="T"&&(gbl_start_var_time=1,gbl_end_var_time=threshold,timeDimArray=gbl_display_list[n],initSlider(1,timeDimArray.length));gbl_remove_search=!0;loadDimMembers(n,r,!0,i,t,!0);gbl_remove_search=!1;$(r).parents(".panel").find(".searchResults").hide();$(this).parents(".panel").find(".searchInput").val("")});$(".removeFilter").click(function(){var n=$(this).attr("data-source"),t=$(this).attr("target-id"),i=$(this).attr("destination_type");$("#_filterTree_"+n).find("input.filter-check:checked").trigger("click");$(this).parents(".panel").find(".searchInput").val("");$(t).parents(".panel").find(".searchResults").hide();$(t).parents(".panel").find(".filterResults").hide();$(".showCountryAggOption").removeClass("active");$(".showCountryAggOption[data-value='All']").addClass("active");i=="T"&&(gbl_start_var_time=1,gbl_end_var_time=threshold,timeDimArray=gbl_display_list[n],initSlider(1,timeDimArray.length))});initPagination()}function invokeSearch(n,t,i,r,u){var o,f,e;gbl_start_var=1;gbl_end_var=threshold;o=$(t).val().trim();o==""?$(t).focus():(f=searchRecordsSV(i,o,"Name"),e=$(f).map(function(n,t){return t.JTC}),e=$.unique(e),f.sort(function(n,t){var i=$(n).attr("JTC"),r=$(t).attr("JTC");return i<r?-1:i>r?1:0}),loadDimMembers(n,r,u,f,e,!0),$(r).parents(".panel").find(".searchResults").show())}function searchRecordsSV(n,t,i){for(var u,s,r,h,e=t.split(" "),o=[],f=0;f<e.length;f++)for(u=new $.jqx.filter,s=u.createfilter("stringfilter",e[f],"contains"),u.addfilter(1,s),r=0;r<n.length;r++)h=u.evaluate(n[r][i])||u.evaluate(n[r].Code),h&&o.push(n[r]);return unique(o)}function initJumpToList(){$("body").on("click",".jumpTo",function(){var n=$(this).text(),u=$(this).parents(".panel").find("li[alphabet="+n+"]").attr("uniqueid"),t=0,t=$(this).parents(".panel").find("li[alphabet="+n+"]").position().top,i=$(this).parents(".panel").find(".variableList").scrollTop(),r=t+i;$(this).parents(".panel").find(".variableList").animate({scrollTop:r},"slow")})}function initSelectAll(){$("body").on("click",".selectAll",function(){$(this).parents(".panel").find(".availableView .chkSelectElement").prop("checked",!0);$(this).parents(".panel").find(".availableView li").addClass("selected");setSelections(this)});$("body").on("click",".unselectAll",function(){$(this).parents(".panel").find(".availableView .chkSelectElement").prop("checked",!1);$(this).parents(".panel").find(".availableView li").removeClass("selected");removecustomvariables(this);setSelections(this)});$("body").on("click",".invertSelection",function(){$(this).parents(".panel").find(".availableView .chkSelectElement").each(function(){$(this).is(":checked")?($(this).prop("checked",!1),$(this).parents("li").removeClass("selected")):($(this).prop("checked",!0),$(this).parents("li").addClass("selected"))});setSelections(this)});$("body").on("click",".removeAll",function(){var n=confirm("Are you sure you want to clear selections for this panel?");n&&($(this).parents(".panel").find(".noVariableTxt").show(),$(this).parents(".panel").find(".availableView li").removeClass("selected"),$(this).parents(".panel").find(".chkSelectElement").prop("checked",!1),removecustomvariables(this),setSelections(this))})}function initSelectMembers(){$(".variableTable").on("click",".chkSelectElement",function(){var n=$(this).prop("checked");n?$(this).parents("li").addClass("selected"):$(this).parents("li").removeClass("selected");setSelectionChange(this)})}function buildSelectFilter(n){$("#divMap"+n).hasClass("collapse")&&($("#report-loading").show(),$.ajax({type:"POST",async:!0,url:"reports.aspx/GetModalMapFilter",contentType:"application/json; charset=utf-8",data:"{filtertype: '"+n+"'}",dataType:"html",success:function(t){var i=$.parseJSON(t).d;$("#divMap"+n).html(i);$(".select-filter-check").off("click");$(".select-filter-check").on("click",function(){loadSelectFilterItems(this)});$("#report-loading").hide()},error:function(){$("#report-loading").hide();window.location.href=gbl_error_file}}))}function initMetadataView(){$("#liMetadata").off("click");$("#liMetadata").on("click",function(){if(hasclearedallselections(!1))return!1;$("#metadataReportVariables").show();$("#liStyles").hide();$("#liLayout").addClass("group1");$("#liEmbed").hasClass("active")&&$("#liLayout a").trigger("click")});$("#liTable, #liChart, #liMap").off("click");$("#liTable, #liChart, #liMap").on("click",function(){if(hasclearedallselections(!1))return!1;$("#metadataReportVariables").hide();$("#liStyles").show();$("#liLayout").removeClass("group1");$("#liEmbed").hasClass("active")&&$("#liLayout a").trigger("click")})}function loadMetaDataVariable(n,t,i,r){var f='<div style="width: 100%; text-align: center;">'+$("#report-loading").html()+"<div>",u;$("#divMetadataCtl div.modal-body").html(f);$("#divMetadataCtl").attr("selection","variable");u=$("#hdnCubeID").val();$.ajax({type:"POST",url:gbl_report_methods+"/PopulateMetaDataJSON_SV",contentType:"application/json; charset=utf-8",data:"{cubeid: '"+u+"', name:'"+n.replace(/\'/g,"%27")+"', code:'"+t+"', dimensiontype:'"+i+"', dimensionname: '"+r+"', lang:'"+gbl_common_culture+"'}",dataType:"json",success:function(r){r.d!=null&&r.d!=""&&($("#divMetadataCtl div.modal-body").html(r.d),$("#gdp-meta-data-rpt").length>0?$("#gdp-meta-data-rpt").css("max-height",Math.round($(window).height()*.5)+"px").css("overflow","auto"):($("#gdp-meta-data").css("max-height",Math.round($(window).height()*.5)+"px").css("overflow","auto"),$("#gdp-meta-data #metadata-specific-data").css("max-height","").css("overflow","")),$("#divMetadataCtl .btn-meta-download").show(),gbl_download_name=n,gbl_download_code=t,gbl_download_type=i)},error:function(){window.location.href=gbl_error_file}})}function loadSelectedDBList(n){var t=$(n).parents(".panel-heading").find(".panel-title a")[0];loadDatabaseList(t)}function loadAvailableDBList(n){var t=$(n).parents(".panel-heading").find(".panel-title a")[0];loadDatabaseList(t)}function loadDatabaseList(n){var u;if(n!=null&&!$(n).hasClass("collapsed")){$(n).parents(".panel-heading").find(".toggleSelectionViews a").removeClass("active");return}$("#report-loading").show();var t="DBList",i="All",r=gbl_array_data[t+"_"+i];r==null?(gbl_array_data[t+"_"+i]="Loading",u=new Date,$.ajax({type:"POST",async:!0,url:gbl_report_methods+"/GetDatabaseListJSON",contentType:"application/json; charset=utf-8",data:"{}",dataType:"json",success:function(n){gbl_array_data[t+"_"+i]=n.d;createDatabaseList(t,i);$("#report-loading").hide();initDragDrop()},error:function(){gbl_array_data[t+"_"+i]=null;$("#report-loading").hide();window.location.href=gbl_error_file}})):(n==null&&createDatabaseList(t,i),$("#report-loading").hide())}function createDatabaseList(n,t){var r="#tbl_"+n,i=gbl_array_data[n+"_"+t];i!=null&&(gbl_array_member_selected[n]==null&&(gbl_array_member_selected[n]=i.Sel),loadFilter(n,t,r,!1,i.Levels),loadDimMembers(n,r,!1,i.Members,i.JTL,!1),getSelectedMembers(n,r))}function loadDatabaseDetails(n){var t='<div style="width: 100%; text-align: center;">'+$("#report-loading").html()+"<div>";$("#dbMetadata div.modal-body").html(t);$.ajax({type:"POST",url:gbl_report_methods+"/PopulateDatabaseDetails",contentType:"application/json; charset=utf-8",data:"{cubeid:'"+n+"', lang:'"+gbl_common_culture+"'}",dataType:"json",success:function(n){n.d!=null&&n.d!=""&&$("#dbMetadata div.modal-body").html(n.d)},error:function(){window.location.href=gbl_error_file}})}function addCustomMember(n,t,i,r,u,f,e){var s=i.displayname,o;return $(t).parent().find(".selectedView li[uniqueId='custom_"+s+"']").length<=0&&(o="<li class='selected' uniqueid='custom_"+s+"'",i.customdefinition!=null&&i.customdefinition.formulaname!=null&&(o+=" formulaname='"+i.customdefinition.formulaname+"' "),o+="> ",f&&(o+="<span class='glyphicon glyphicon-plus-sign plusIcon'><\/span> "),o+="<span class='deleteIcon glyphicon glyphicon-remove-circle'><\/span>  ",o+="<span class='value'>"+s+"<\/span>  ",o+="<a href='javascript:void(0)'  class='editLnk'onclick=\""+u+"('"+n+"', '"+s+"')\">Edit<\/a><\/li>",r&&$(t).parent().find(".selectedView").append(o),i.customdefinition!=null&&i.customdefinition.periods!=null&&i.customdefinition.periods.length>0&&($tblavailable=$("#tbl_"+n),$.each(i.customdefinition.periods,function(n,t){$tblavailable.find("input[id='chk"+t.uniquename+"']").prop({checked:!0}).attr("disabled",!0)}))),e!=""&&alert("New Custom "+e+" added sucessfully."),o}function addCustomPeriod(n){var o,p,s,h,c,l,a;gbl_array_member_selected[n]==null&&(gbl_array_member_selected[n]={});var i=gbl_array_member_selected[n],e=$("#selPeriodFunctionType").val(),u=$("#txtTimeFunctionName").val().trim(),w=$("#selCustomTime_From").val(),b=$("#selCustomTime_To").val(),k=$("#txtTimeMetadata").val(),d=$("#chkTimeDisplayDef").prop("checked"),v=$("#selMRVOrder").val(),y=$("#txtMRVLabel").val().trim();gbl_common_internal&&(o=$("#chkTimeHideTitle").prop("checked"),p=$("#chkTimeHideLabel").prop("checked"));var g=$("#selCustomTime_From option:selected").text(),nt=$("#selCustomTime_To option:selected").text(),f={},t={},r=null;if(u==""){alert("Please enter function title.");return}if(r=i["custom_"+u],r==null||confirm("Custom Period already exists. Do you want to overwrite?")){if(f.displayname=u,f.custom=!0,t.functiontype=e,e=="DynYear"){if(s=$.grep(Object.keys(i),function(n){return i[n].custom==!0&&i[n].customdefinition!=null&&i[n].customdefinition.functiontype.toLowerCase()=="dynyear"}),s.length>0&&i[s[0]].displayname!=u){alert("Only one dynamic period is allowed");return}if(h=$("#selDynPeriodTotal").val(),c=$("#selDynPeriodLatest").val(),t.totalperiod=h,t.latestperiod=c,$("#report-loading").show(),l=!1,$.ajax({type:"POST",async:!1,url:gbl_report_methods+"/PopulateDynamicYears",contentType:"application/json; charset=utf-8",data:"{controlid: '"+n+"', totalperiods: '"+h+"', latestperiods: '"+c+"'}",dataType:"json",success:function(i){t.periods=i.d;$tblavailable=$("#tbl_"+n);r!=null&&r.customdefinition!=null&&r.customdefinition.periods!=null&&$.each(r.customdefinition.periods,function(n,t){$tblavailable.find("input[id='chk"+t.uniquename+"']").prop({checked:!1}).removeAttr("disabled")});$.each(i.d,function(n,t){$tblavailable.find("input[id='chk"+t.uniquename+"']").prop("checked")&&$tblavailable.find("input[id='chk"+t.uniquename+"']").trigger("click");$tblavailable.find("input[id='chk"+t.uniquename+"']").prop({checked:!0}).attr("disabled",!0)});l=!0;$("#report-loading").hide()},error:function(){$("#report-loading").hide();window.location.href=gbl_error_file}}),!l)return}else{t.uname_from=w;t.uname_to=b;t.year_from=g;t.year_to=nt;t.metainfo=htmlEncode(k);t.displaydef=d;switch(e){case"MRV":t.mrvorder=v;gbl_common_internal&&(t.mrv_hidetitle=o);break;case"MRVRight":case"MRVLeft":if(y==""){alert("Please enter MRV Label");return}t.mrvorder=v;t.mrvlabel=y;gbl_common_internal&&(t.mrv_hidetitle=o,t.mrv_hidelabel=p)}}f.customdefinition=t;i["custom_"+u]=f;a="#tbl_"+n;addCustomMember(n,a,f,!0,"editCustomPeriod",!1,"Period");getSelectedCount(n,a);clearCustomPeriod();showSelectionsChanged(n)}}function editCustomPeriod(n,t){gbl_array_member_selected[n]==null&&(gbl_array_member_selected[n]={});var r=gbl_array_member_selected[n],u=r["custom_"+t],i=u.customdefinition;if($("#txtTimeFunctionName").val(t),$("#selPeriodFunctionType").val(i.functiontype),$("#selPeriodFunctionType").val()=="DynYear")$("#selDynPeriodTotal").val(i.totalperiod),$("#selDynPeriodLatest").val(i.latestperiod);else{$("#selCustomTime_From").val(i.uname_from);$("#selCustomTime_To").val(i.uname_to);$("#txtTimeMetadata").val(htmlDecode(i.metainfo));$("#chkTimeDisplayDef").prop({checked:i.displaydef});switch(i.functiontype){case"MRV":$("#selMRVOrder").val(i.mrvorder);gbl_common_internal&&$("#chkTimeHideTitle").prop({checked:i.mrv_hidetitle});break;case"MRVRight":case"MRVLeft":$("#selMRVOrder").val(i.mrvorder);$("#txtMRVLabel").val(i.mrvlabel);gbl_common_internal&&($("#chkTimeHideTitle").prop({checked:i.mrv_hidetitle}),$("#chkTimeHideLabel").prop({checked:i.mrv_hidelabel}))}}$("#selPeriodFunctionType").trigger("change");$("#createTimeFunctionAcc").parents("#zoomModalBody").hasClass("modal-body")&&$("#zoomModalBody").find(".openBtnModal").trigger("click");$('#createTimeFunctionAcc div div.panel-heading a[href="#createTimeFunction"]').hasClass("collapsed")&&$('#createTimeFunctionAcc div div.panel-heading a[href="#createTimeFunction"]').trigger("click")}function clearCustomPeriod(){$("#txtTimeFunctionName").val("");$("#txtMRVLabel").val("");$("#txtTimeMetadata").val("");$("#chkTimeDisplayDef").prop({checked:!1});gbl_common_internal&&($("#chkTimeHideTitle").prop({checked:!1}),$("#chkTimeHideLabel").prop({checked:!1}))}function initCustomPeriodSettings(){$("#selPeriodFunctionType").change(function(){var n=$(this).val();switch(n){case"MRV":$("#rowSpan").show();$("#rowOrder").show();$("#rowLabel").hide();$("#rowDynPeriod").hide();$("#divTimeHideTitle").show();$("#divTimeHideLabel").hide();$("#divTimeAddtOptions").show();break;case"MRVRight":case"MRVLeft":$("#rowSpan").show();$("#rowOrder").show();$("#rowLabel").show();$("#rowDynPeriod").hide();$("#divTimeHideTitle").show();$("#divTimeHideLabel").show();$("#divTimeAddtOptions").show();break;case"DynYear":$("#rowSpan").hide();$("#rowOrder").hide();$("#rowLabel").hide();$("#rowDynPeriod").show();$("#divTimeHideTitle").hide();$("#divTimeHideLabel").hide();$("#divTimeAddtOptions").hide();break;default:$("#rowSpan").show();$("#rowOrder").hide();$("#rowLabel").hide();$("#rowDynPeriod").hide();$("#divTimeHideTitle").hide();$("#divTimeHideLabel").hide();$("#divTimeAddtOptions").show()}})}function showSelectionsChanged(n){var i,t;$("#divNoDataToDisplay").is(":hidden")?($("#faded").show(),i=$("#panel_"+n).position(),$(".selectionModifyTxt").show(),$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide(),$(".selectionModifyTxt").attr("panel-id","#panel_"+n)):(t=0,$(".selectionCountRHS").each(function(){var n=eval($(this).text());(n==null||n<1||n=="")&&t++}),t>0?$("#applyChangesNoPreview").addClass("disabled"):$("#applyChangesNoPreview").removeClass("disabled"))}function showVariableDropdown(){$(".toggleDropDown,.dropDownWrapper,.filterTree,.toggleFilter").click(function(n){n.stopPropagation()});$(".toggleDropDown,.dropDownWrapper").click(function(n){n.stopPropagation()})}function show(n){$(n).css("visibility","visible");$(".dropDownWrapper").slideUp()}function hide(n){$(n).css("visibility","hidden")}function cancel(n){$(n).slideUp()}function togglFilter(){$(".toggleDropDown,.toggleFilter").click(function(){$(this).next().slideToggle()})}function openCustomDiv(n,t,i){$(i).is(":checked")?$(t).show():$(t).hide()}function resetVariables(){$("input[type=checkbox],input[type=radio]").removeAttr("checked")}function checkSelectedPageLoad(){$(".chkSelectElement").prop("checked",!1);$(".variableTable li.selected").each(function(){$(this).find(".chkSelectElement").prop("checked",!0)})}function checkSelected(n){oldList=fetchOldSelection(n);$(".chkSelected").each(function(){chkBoxId="#"+$(this).attr("id");var n="#select_"+chkBoxId.split("_")[1];$(chkBoxId).is(":checked")?($(n).prop("checked",!0),$(n).parent().addClass("selected")):($(n).prop("checked",!1),$(n).parent().removeClass("selected"))})}function checkSelectedDb(n){n=n.trim();$("#databaseTable").find("li").removeClass("selected");$("#databaseTable").find(".value").each(function(){if($(this).text().trim()==n)return $(this).parents("li").addClass("selected"),$(this).siblings(".selectDb").prop("checked",!0),!1})}function deleteItem(n){$(n).parent().remove()}function clearField(n){$(n).html("");$(n).val("")}function resetCustomGrpSel(){}function populateFormulaDiv(){}function checkBoxSelection(){$(".variableTable").on("click",".selectCountry,.selectSeries",function(){$(this).is(":checked")&&$(this).parent().addClass("selected")})}function populateSelectionList(n,t){$(n).html("");$(t).find(".chkSelectElement").each(function(){if($(this).is(":checked")){var t=$(this).attr("id").split("_")[1],i=selectionItemStr+t+"'/> "+$(this).next().html()+"<\/li>";$(n).append(i)}})}function populateDbSelectionList(){$("#databaseTable").find(".selectDb").each(function(){$(this).is(":checked")&&$("#selectedDb").text($(this).siblings(".value").text().trim())})}function initTreeView(){$(".selector,.masterSelector").prop("checked",!1);$(".masterSelector").on("click",function(){$(this).is(":checked")?$(this).parent().next().find(".selector").prop("checked",!0):$(this).parent().next().find(".selector").prop("checked",!1)});$(".selector").on("click",function(){$(this).is(":checked")?$(this).parents(".childNodes").find(".selector").each(function(){var n=$(this).prop("checked");return n==!0&&$(this).parents(".childNodes").siblings(".parentNode").find(".masterSelector").prop("checked",!0),n==!1?($(this).parents(".childNodes").siblings(".parentNode").find(".masterSelector").prop("checked",!1),!1):void 0}):$(this).parents(".childNodes").siblings(".parentNode").find(".masterSelector").prop("checked",!1)})}function viewToggler(){$(".closeBtn").on("click",function(){$(this).hide();$(".openBtn").show();$(".jqx-splitter-collapse-button-vertical").trigger("click")});$(".openBtn").on("click",function(){$(this).hide();$(".closeBtn").show();$(".jqx-splitter-collapse-button-vertical").trigger("click")});$("#splitter").on("collapsed",function(){$(".tools").hide()});$("#splitter").on("expanded",function(){$(".tools").show()})}function initDragDrop(){$(".variableTable.availableView li").draggable({appendTo:"body",helper:"clone",cursor:"move",cursorAt:{top:0,left:0}});$(".customGroupElements").droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:":not(.ui-sortable-helper)",drop:function(n,t){$(this).find(".placeholder").remove();var i="<li><a href='javascript:void(0)' onclick='deleteItem(this)' ><span class='glyphicon glyphicon-remove-circle'><\/span><\/a>"+t.draggable.text()+"<\/li>";$(this).append(i);$("#faded").show();$(".selectionModifyTxt").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}}).sortable({items:"li:not(.placeholder)",sort:function(){$(this).removeClass("ui-state-default")}});$("#metadataCountryTable").sortable({revert:!0});$("#metadataAttrTable").sortable({revert:!0});$("body").on("click","#chartOrientationOption",function(){$("#chartCustomOrientationList").sortable({revert:!0})})}function addSelectedClass(){$("#databaseTable").on("click",".selectDb",function(){$("#databaseTable").find("li").removeClass("selected");var n=$(this).prop("checked");n?$(this).parents("li").addClass("selected"):$(this).parents("li").removeClass("selected")})}function hideOnDocClick(){$(document).click(function(){$(".dropDownWrapper,.filterTree").hide()})}function toggleSelectionView(){$("body").on("click",".expandPanel",function(){if($(this).hasClass("collapsed"))$("#nonMetadataReportVariables").on("shown.bs.collapse",function(){if($(".selectionModifyTxt").is(":visible"))var n=$(".selectionModifyTxt").attr("panel-id"),t=$(n).position()});else{$(this).parents(".panel-heading").find(".showAvailable").removeClass("active");$(this).parents(".panel-heading").find(".showSelected").removeClass("active");$("#nonMetadataReportVariables").on("hidden.bs.collapse",function(){if($(".selectionModifyTxt").is(":visible"))var n=$(".selectionModifyTxt").attr("panel-id"),t=$(n).position()})}});$(".panel.panel-default").on("click",".showAvailable",function(){if($(this).parents(".panel.panel-default").find(".selectedView").hide(),$(this).parents(".panel").find(".availableView").show(),$(this).parents(".panel").find(".availableViewTools").show(),$(this).parents(".panel").find(".selectedViewTools").hide(),$(this).parents(".panel.panel-default").find(".dimensionHolderInner").removeClass("variableTableSelectionView"),$(".panel-title.pull-left.main-title-panel a").addClass("collapsed"),$(".selectedDimensionPanel").removeClass("in").addClass("collapse"),$(".showAvailable,.showAvailableMeta").removeClass("active"),$(this).addClass("active"),$(".showSelected,.showSelectedMeta").removeClass("active"),$(this).parents(".panel").find(".panel-title a").hasClass("collapsed")){$(this).parents(".panel").find(".panel-title a").removeClass("collapsed");$(this).parents(".panel").find(".selectedDimensionPanel").removeClass("collapse").addClass("in");$(this).parents(".panel").find(".selectedDimensionPanel").css("height","auto");return}});$("#zoomModalHeader").on("click",".showAvailable",function(){$("#zoomModalHeader").find(".showSelected").removeClass("active");$(this).addClass("active");$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".selectedView").hide();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".availableView").show();$(this).parents(".modal-content").find(".dimensionHolderInner").removeClass("variableTableSelectionView");$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".availableViewTools").show();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".selectedViewTools").hide()});$("#zoomModalHeader").on("click",".showSelected",function(){$("#zoomModalHeader").find(".showAvailable").removeClass("active");$(this).addClass("active");$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".availableView").hide();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".selectedView").show(function(){$(this).parents(".panel").find("#ascendingChkBox").prop("checked")||$(this).parents(".panel").find(".selectedView").sortable({revert:!0,stop:function(){$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}});myhelper=function(n){return $("span",$(n)).text()};$("body").on("click",".sort.asc",function(){sortAllSelectedItems($(this).parents(".panel").find(".selectedView"),!0);$(this).removeClass("asc").addClass("desc");$("#divNoDataToDisplay").is(":hidden")&&($("#faded").show(),$(".selectionModifyTxt").show())});$("body").on("click",".sort.desc",function(){sortAllSelectedItems($(this).parents(".panel").find(".selectedView"),!1);$(this).removeClass("desc").addClass("asc");$("#divNoDataToDisplay").is(":hidden")&&($("#faded").show(),$(".selectionModifyTxt").show())});$("body").on("click",".deleteIcon",function(){var n=$(this).parents("li").attr("uniqueid");n.indexOf("custom_")<0&&($(this).parents(".panel").find(".availableView li[uniqueid='"+n+"']").removeClass("selected"),$(this).parents(".panel").find(".availableView li[uniqueid='"+n+"']").find(".chkSelectElement").prop("checked",!1));setSelectionChangeEx(this,!1,".selectedView");$(this).parents("li").remove()})});$(this).parents(".modal-content").find(".dimensionHolderInner").addClass("variableTableSelectionView");$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".availableViewTools").hide();$(this).parents("#zoomModalHeader").siblings("#zoomModalBody").find(".selectedViewTools").show()});$(".panel.panel-default").on("click",".showSelected",function(){if($(".panel-title.pull-left.main-title-panel a").addClass("collapsed"),$(".selectedDimensionPanel").removeClass("in").addClass("collapse"),$(this).parents(".panel").find(".availableView").hide(),$(this).parents(".panel").find(".availableViewTools").hide(),$(this).parents(".panel").find(".selectedViewTools").show(),$(this).parents(".panel").find(".selectedView").show(function(){$(this).parents(".panel").find("#ascendingChkBox").prop("checked")||$(this).parents(".panel").find(".selectedView").sortable({revert:!0,stop:function(){$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}});myhelper=function(n){return $("span",$(n)).text()};$("body").on("click",".sort.asc",function(){sortAllSelectedItems($(this).parents(".panel").find(".selectedView"),!0);$(this).removeClass("asc").addClass("desc");$("#divNoDataToDisplay").is(":hidden")&&($("#faded").show(),$(".selectionModifyTxt").show())});$("body").on("click",".sort.desc",function(){sortAllSelectedItems($(this).parents(".panel").find(".selectedView"),!1);$(this).removeClass("desc").addClass("asc");$("#divNoDataToDisplay").is(":hidden")&&($("#faded").show(),$(".selectionModifyTxt").show())});$("body").on("click",".deleteIcon",function(){var n=$(this).parents("li").attr("uniqueid");n.indexOf("custom_")<0&&($(this).parents(".panel").find(".availableView li[uniqueid='"+n+"']").removeClass("selected"),$(this).parents(".panel").find(".availableView li[uniqueid='"+n+"']").find(".chkSelectElement").prop("checked",!1));setSelectionChangeEx(this,!1,".selectedView");$(this).parents("li").remove()})}),$(this).parents(".panel.panel-default").find(".dimensionHolderInner").addClass("variableTableSelectionView"),$(".showSelected, .showSelectedMeta").removeClass("active"),$(this).addClass("active"),$(".showAvailable,.showAvailableMeta").removeClass("active"),$(this).parents(".panel").find(".panel-title a").hasClass("collapsed")){$(this).parents(".panel").find(".panel-title a").removeClass("collapsed");$(this).parents(".panel").find(".selectedDimensionPanel").removeClass("collapse").addClass("in");$(this).parents(".panel").find(".selectedDimensionPanel").css("height","auto");return}});$("body").on("click","#ascendingChkBox",function(){$(this).prop("checked")?($(this).parents(".panel").find(".selectedView").sortable("disable"),myhelper=function(n){return $("span",$(n)).text()},sortTimeAscending($(this).parents(".panel").find(".selectedView"))):$(this).parents(".panel").find(".selectedView").sortable({revert:!1,stop:function(){$(".selectionModifyTxt").show();$("#faded").show();$(".downloadMsg").is(":visible")&&$(".downloadMsg").hide()}})})}function showAvailableSelectedView(){$("#selection").on("click",".panel-title a",function(){$(".showAvailable").removeClass("active");$(".showSelected").removeClass("active");$(this).parents(".panel").find(".availableView").show();$(this).parents(".panel").find(".selectedView").hide();$(this).parents(".panel").find(".availableViewTools").show();$(this).parents(".panel").find(".selectedViewTools").hide();$(this).parents(".panel").find(".showAvailable").addClass("active");$(this).parents(".panel").find(".showAvailableMeta").addClass("active")})}function showPlusIconOnExpand(){$(".changeIcon").on("show.bs.collapse",function(){$(this).parents(".panel").find(".variableTable").addClass("customGroupView")});$(".changeIcon").on("hide.bs.collapse",function(){$(this).parents(".panel").find(".variableTable").removeClass("customGroupView")})}function radioBtnTab(){$("body").on("click",".radioBtnTabs",function(){var n="#"+$(this).attr("data-target");$(this).parents(".btn-group").siblings(".radioTabContentWrapper").find(".radioTabContent").hide();$(n).show()});$("body").on("click",".radioBtnTabsInner",function(){var n="#"+$(this).attr("data-target");$(this).parents(".btn-group-inner").siblings(".radioTabContentInner").hide();$(n).show()})}function appendIndicator(){var n="";$("#seriesTable li.selected").each(function(){var t=$(this).find(".value").text();n=n+"<tr><td>"+t+"<\/td>\n<td><select><option>None<\/option><option>Mean<\/option> <option>Median<\/option><option>Min<\/option> <option>Sum<\/option><\/select><\/td>\n<td><select><option>None<\/option><\/select><\/td>\n<td> <input type='text' class='form-control' /><\/td><\/tr>"});$("#tb-indicatorAggRule tbody").html(n)}function getHeaderFooterHeight(){var n=$("#bannerStrip").outerHeight();return n+=$(".language ul li").length>0?$(".language").outerHeight():0,n+=$(".secondaryHeader").outerHeight(),n+=$(".footerStrip").outerHeight(),n+16}function positionElements(){var n=$(window).height(),f=$(window).width(),i=n-130;$(".preview").css("min-height",i+"px");$(".colTools").css("min-height",n-getHeaderFooterHeight()+"px");$(".reportPlaceholder").css("width",$(".colCanvas").width()-45+"px");var t=$(".colCanvas").offset(),r=t.left,u=t.top;$("#fixedLayout").css({top:u,left:r})}function showToolTip(){$(".showToolTip").tooltip({placement:"bottom"});gbl_common_culture=="ar"?($(".toolTipLeft").tooltip({placement:"left"}),$(".toolTipRight").tooltip({placement:"right"})):($(".toolTipLeft").tooltip({placement:"right"}),$(".toolTipRight").tooltip({placement:"left"}))}function initAutoCompleteVar(n,t,i){var r=new $.jqx.dataAdapter(t);$(n).jqxInput({placeHolder:"Search",height:24,width:"85%",minLength:1,source:r,displayMember:i,items:8})}function initSlider(n,t){$("#slider-range").slider({range:!0,min:n,max:t,values:[n,t],slide:function(){},stop:function(n,t){var u,f;$(this).parents(".variableListWrapper").find(".searchResults").show();u=$("#slider-range").slider("values",0);f=$("#slider-range").slider("values",1);gbl_start_var_time=1;gbl_end_var_time=threshold;var i=[],e=$(this).attr("data-source"),o=$(this).attr("target-id"),s={dataType:"json",dataFields:[{name:"ID",type:"string"},{name:"Code",type:"string"},{name:"Name",type:"string"},{name:"JTC",type:"string"},{name:"SM",type:"boolean"}],localdata:timeDimArray},r=new $.jqx.dataAdapter(s,{loadComplete:function(n){for(var n=r.records,f=n.length,n=n.reverse(),u=t.values[0]-1;u<t.values[1];u++)i.push(n[u]),u==t.values[0]-1&&(startText=n[u].Name),u==t.values[1]-1&&(endText=n[u].Name);$("#year").text(endText+" - "+startText)}});r.dataBind();i.reverse();stringBuilder_Time(e,o,!1,i)}})}function getSelected(n,t){for(var i=0;i<n.length;i++)switch(n[i].datalevel){case"1":if(n[i].datavalue==t.Level1Code)return!0;break;case"2":if(n[i].datavalue==t.Level2Code)return!0;break;case"3":if(n[i].datavalue==t.Level3Code)return!0;break;case"4":if(n[i].datavalue==t.Level4Code)return!0}return!1}function getMemberList(n){var t="";$.each(n,function(n,i){t+="<li>";t+='<a data-toggle="modal" data-target="#seriesMetaDataModal"><span class="glyphicon glyphicon-eye-open metadataIcon sprite icon-info"><\/span><\/a>';t+='<span class="glyphicon glyphicon-plus-sign plusIcon"><\/span>';t+='<input type="checkbox" id="select_ind_'+i.IndicatorCode+'" class="chkSelectElement" />';t+='<span class="value">'+i.IndicatorName+"<\/span>";t+="<\/li>"});$("#seriesTable").html(t)}function getFilterLevels(n){var t="<li>";switch(n.Level){case 1:t+='<div class="parentNode">';t+="<span class='toggleList'><\/span>";t+='<input type="checkbox" class="masterSelector filter-check" data-value="'+n.UniqueID+'" data-level="'+n.Level+'" />'+n.Name+"<\/div>";break;case 2:case 3:case 4:t+='<input type="checkbox" class="selector filter-check" data-value="'+n.UniqueID+'" data-level="'+n.Level+'" />'+n.Name}return n.Hierarchies.length>0&&(t+='<ul class="childNodes level'+n.Level+'">',$.each(n.Hierarchies,function(n,i){t+=getFilterLevels(i)}),t+="<\/ul>"),t+="<\/li>"}function viewRecentYears(){}function cloneDivs(){$("body").on("click",".closeZoomModal",function(){var n=$(this).attr("destination_panel"),i=$(n).find(".dimensionHolder"),r,t;$("#zoomModalBody .dimensionHolderInner").appendTo(i);r=$(n).find(".variableTable li.selected").length;t=$(n).siblings(".panel-heading").find(".statsWrapper");$("#zoomModalHeader .statsInner").appendTo(t);$(n).find(".variableList").css("max-height","250px");$(n).find(".modal-leftCol").css({width:"100%"});$(n).find(".modal-rightCol").css({width:"100%"});$(n).find(".modal-rightCol").show();$("#ul-addMoreDimension").appendTo(".addRemoveVariables");$(".addMoreHiddenDiv").show();listUnselectedVariables(!1)});$("body").on("click",".zoom",function(){var r,i,n,u,s,f,e,t,o;$(".addMoreHiddenDiv").show();$(".closeZoomModal").attr("destination_panel",r);r=$(this).attr("destination_panel");i=$(this).attr("target_panel");$(this).parents("#zoomModalHeader").hasClass("modal-header")&&(n=$(".closeZoomModal").attr("destination_panel"),u=$(n).find(".dimensionHolder"),$("#zoomModalBody .dimensionHolderInner").appendTo(u),s=$(n).find(".variableTable li.selected").length,f=$(n).siblings(".panel-heading").find(".statsWrapper"),$("#zoomModalHeader .statsInner").appendTo(f),$(n).find(".variableList").css("max-height","250px"),$(n).find(".modal-leftCol").css({width:"100%"}),$(n).find(".modal-rightCol").css({width:"100%"}),$(n).find(".modal-rightCol").show(),$("#ul-addMoreDimension").appendTo(".addRemoveVariables"));$(".closeZoomModal").attr("destination_panel",r);$("#ul-addMoreDimension").appendTo("#zoomModalHeader");$(i).find(".statsInner").appendTo("#zoomModalHeader");e=$(this).attr("target_panel");t=$(e+" .panel-heading h4.panel-title a").text();t==null&&(t="");t=t.trim();$(i).find(".dimensionHolderInner").appendTo("#zoomModalBody");$("#zoomModalBody").attr("destination-panel",i);$("#zoomModalBody").css("height",$(window).height()-200);$("#zoomModalBody .variableList").css("max-height",$(window).height()-315);$("#zoomModalBody .variableTable").hasClass("table-dimension-T")&&$("#zoomModalBody .variableList").css("max-height",$(window).height()-390);$("#zoomModalTitle").text(t);$("#zoomModalBody").find(".variableTable.availableView").hasClass("customGroupView")?($("#zoomModalBody").find(".modal-leftCol").css("width","70%"),$("#zoomModalBody").find(".modal-rightCol").css("width","25%"),$("#zoomModalBody").find(".modal-rightCol").show(),$("#zoomModalBody").find(".closeBtnModal").show(),$("#zoomModalBody").find(".openBtnModal").show(),$(this).attr("destination_type")=="M"&&($("#zoomModalBody .viewToggler.openBtnModal").hide(),$("#zoomModalBody .viewToggler.closeBtnModal").hide())):($("#zoomModalBody").find(".modal-leftCol").css("width","95%"),$("#zoomModalBody").find(".modal-rightCol").hide(),$("#zoomModalBody").find(".closeBtnModal").hide(),$("#zoomModalBody").find(".openBtnModal").show(),$(this).attr("destination_type")=="T"||gbl_common_internal||($("#zoomModalBody .viewToggler.openBtnModal").hide(),$("#zoomModalBody .viewToggler.closeBtnModal").hide()),$(this).attr("destination_type")=="T"&&$("#zoomModalBody").find(".openBtnModal").show());o=$(this).attr("parent-li");$(o).hide();$("#zoomModalBody .variableTable").css("max-height",$(window).height()-315);adjustVariableListWidth();$("#zoomModalBody .tree").css("max-height",$(window).height()-330)});$("#zoomView").on("shown.bs.modal",function(){$("#zoomModalBody .variableList").css("max-height",$(window).height()-315);$("#zoomModalBody .variableTable").hasClass("table-dimension-T")&&$("#zoomModalBody .variableList").css("max-height",$(window).height()-345);$("#zoomModalBody .tree").css("max-height",$(window).height()-330);adjustVariableListWidth()});$("#zoomView").on("hidden.bs.modal",function(){$(".variableList").css("max-height","");$(".variableList").width("100%");$(".tree").css("max-height","")})}function adjustVariableListWidth(){($("#zoomModalBody .variableTable").attr("data-type")=="S"||$("#zoomModalBody .variableTable").attr("data-type")=="C")&&$("#zoomModalBody").find(".variableList").width($("#zoomModalBody .modal-leftCol").width()-$("#zoomModalBody").find(".filterTree").width()-5+"px")}function showAdditionalOptions(){$("body").on("click",".showAdditionalOptions",function(){$(this).toggleClass("active");$(this).next().slideToggle()});$("#zoomModalBody").on("click",".openBtnModal",function(){$(this).hide();$(this).siblings(".closeBtnModal").show();$(this).parents(".modal-body").find(".modal-leftCol").css("width","60%");$(this).parents(".modal-body").find(".modal-rightCol").css("width","35%");$(this).parents(".modal-body").find(".modal-rightCol").show();$(this).parents(".modal-body").find(".variableList").addClass("modal-custom-open");adjustVariableListWidth()});$("#zoomModalBody").on("click",".closeBtnModal",function(){$(this).hide();$(this).siblings(".openBtnModal").show();$(this).parents(".modal-body").find(".modal-leftCol").css("width","95%");$(this).parents(".modal-body").find(".modal-rightCol").hide();$(this).parents(".modal-body").find(".variableList").removeClass("modal-custom-open");adjustVariableListWidth()})}function setIframeDimension(){$("#createCustomThemeModal").on("shown.bs.modal",function(){$("#customTableHolder").attr("width",$("#createCustomThemeModal .modal-content").width()-50);$("#customTableHolder").attr("height",$("#createCustomThemeModal .modal-content").height()-100);typeof $("#customTableHolder")[0].contentWindow.adjustFrameHeight==typeof Function&&$("#customTableHolder")[0].contentWindow.adjustFrameHeight()})}function moveAddMoreLinksToRHS(){$(".addMoreHiddenDiv").each(function(){$(this).appendTo("#ul-addMoreDimension")})}function triggerClickOnEnter(){$(".searchInput").keyup(function(n){n.keyCode==13&&$(this).next().click()})}function sortAllSelectedItems(n,t){var i=n.children("li").get(),r=n.attr("data-type");r=="O"?t?i.sort(function(n,t){var i=$(n).attr("uniqueid"),r=$(t).attr("uniqueid");return i<r?-1:i>r?1:0}):i.sort(function(n,t){var i=$(n).attr("uniqueid"),r=$(t).attr("uniqueid");return i>r?-1:i<r?1:0}):t?i.sort(function(n,t){var i=$(n).find("span.value").text().toUpperCase(),r=$(t).find("span.value").text().toUpperCase();return i<r?-1:i>r?1:0}):i.sort(function(n,t){var i=$(n).find("span.value").text().toUpperCase(),r=$(t).find("span.value").text().toUpperCase();return i>r?-1:i<r?1:0});$.each(i,function(t,i){n.append(i)})}function sortTimeAscending(n){var t=n.children("li").get();t.sort(function(n,t){var i=$(n).find("span.value").text().toUpperCase(),r=$(t).find("span.value").text().toUpperCase();return i<r?-1:i>r?1:0});$.each(t,function(t,i){n.append(i)})}function createPagerDropdown(n,t){for(var u=t.length,f=Math.ceil(u/threshold),r="",i=1;i<=f;i++)r+="<option>"+i+"<\/option>";$("#goTo_"+n).html("");$("#goTo_"+n).append(r)}function toggleFilterHierarchy(){}function gridRenderingSettings(){$(".dxgvTable_GridDefaultTheme tr:first-child").show();gbl_common_culture=="ar"?$(".dxgvFCSD").scrollLeft("0"):$(".dxgvFCSD").scrollLeft($(".dxgvFCSD div").width())}function showSubnationals(){$("body").on("click",".caret-n",function(){var n=$(this).parents(".national").attr("parent");$(this).toggleClass("caret-n-open");$(".subnational[child="+n+"]").toggle();$(this).parents(".national").find(".nationalName").toggle()});$("body").on("click",".selectAllSub",function(){var n=$(this).parents(".national").attr("parent");$(".subnational[child="+n+"]").find(".chkSelectElement").prop("checked",!1);$(".subnational[child="+n+"]").find(".chkSelectElement").trigger("click");$(this).parents(".national").find(".chkSelectElement").prop("checked",!1);$(this).parents(".national").find(".chkSelectElement").trigger("click");$(this).parents(".national").find(".closed").hasClass("caret-n-open")||$(this).parents(".national").find(".closed").trigger("click")});$("body").on("click",".unselectAllSub",function(){var n=$(this).parents(".national").attr("parent");$(".subnational[child="+n+"]").find(".chkSelectElement").prop("checked",!0);$(".subnational[child="+n+"]").find(".chkSelectElement").trigger("click");$(this).parents(".national").find(".chkSelectElement").prop("checked",!0);$(this).parents(".national").find(".chkSelectElement").trigger("click");$(this).parents(".national").find(".closed").hasClass("caret-n-open")||$(this).parents(".national").find(".closed").trigger("click")})}function initBookAttributes(){$.ajax({type:"POST",async:!0,url:gbl_report_methods+"/PopulateBookAttributesJSON",contentType:"application/json; charset=utf-8",data:"{}",dataType:"json",success:function(n){gbl_array_book_attributes=eval(n.d)},error:function(){window.location.href=gbl_error_file}})}function validateBookUnits(){var u=!0,n=[],t=[],o=$('.variableTable.selectedView[data-type="S"]').attr("data-value"),s="#tbl_"+o;for($(s).parent().find(".selectedView li").each(function(n,i){t.push($(i).attr("uniqueid"))}),t.length==0&&$.ajax({type:"POST",async:!1,url:gbl_report_methods+"/PopulateSelectedIndicatorsJSON",contentType:"application/json; charset=utf-8",data:"{}",dataType:"json",success:function(n){var i=eval(n.d);for(var r in i)t.push(i[r].uniquename)}}),rowid=0;rowid<t.length;rowid++)n.push($.grep(gbl_array_book_attributes,function(n){return n.seriesId==t[rowid]}));var f=[],r=0,e=0;for(i=0;i<n.length;i++)n[i].length>0?f.indexOf(n[i][0].bookUnit)===-1&&(f.push(n[i][0].bookUnit),r++):e++;return(r>0&&e>0||r>1)&&(u=!1),u}var selectionItemStr="<li>  <input type='checkbox' checked='checked' class='chkSelectElement' id='selected_",oldList="",customIndicatorLi="<li class='selected'> <a href='javascript:void(0)' onclick='viewMetaData(this)'><span class='metadataIcon sprite icon-info'><\/span><\/a>  <span class='glyphicon glyphicon-plus-sign plusIcon'><\/span> <input type='checkbox' checked='checked' class='chkSelectElement' id='select_",customIndicatorLiMiddle="<\/span>  <a href='javascript:void(0)'  class='editLnk'",customIndicatorLiTail=">Edit<\/a><\/li>",agentWidth=0,gbl_array_data={},gbl_array_member_list={},gbl_array_member_selected={},gbl_array_member_selected_clone={},gbl_array_book_attributes,threshold=3e3,gbl_start_var=1,gbl_end_var=threshold,gbl_remove_search=!1,gbl_display_list={},startText="",endText="",gbl_start_var_time=1,gbl_end_var_time=threshold,timeDimArray=[],liCounter=0,timePaging=!1,isdownloadlimit=!1,gbl_SubnationalFilter=gbl_SubnationalCubeid.indexOf($("#hdnCubeID").val()+",")>=0;$(document).ready(function(){moveAddMoreLinksToRHS();initMetadataView();initSearch();initJumpToList();initSelectAll();initSelectMembers();setIframeDimension();initCustomPeriodSettings();gbl_HasIndicatorUnit&&initBookAttributes();$(document).resize(function(){$(document).width<1024&&$("body").css({width:"1024px","overflow-x":"auto"})});triggerClickOnEnter();$("#btnMapRegion").off("click");$("#btnMapRegion").on("click",function(){buildSelectFilter("Region")});$("#btnMapIncome").off("click");$("#btnMapIncome").on("click",function(){buildSelectFilter("Income")});$("body").on("click","#liMetadataDownloadAdvanced",function(){setActiveTab("#lblAllMetadata","#allAvailableMetadata")});toggleFilterHierarchy();filterCountryAggregates();$("body").addClass(gbl_common_culture);gbl_SubnationalFilter&&showSubnationals()});$(document).ready(function(){positionElements();$(".collapsedOption").click(function(){$(this).hide();$(this).next().show()});$(".expandedOption h4").click(function(){$(this).parent().hide();$(this).parent().siblings(".collapsedOption").show()});showVariableDropdown();togglFilter();checkSelectedPageLoad();initTreeView();$("#tableView").show();viewToggler();addSelectedClass();hideOnDocClick();showToolTip();$(window).resize(function(){positionElements();$("#zoomView").hasClass("in")&&adjustVariableListWidth()});toggleSelectionView();showAvailableSelectedView();showPlusIconOnExpand();radioBtnTab();viewRecentYears();cloneDivs();showAdditionalOptions();$(".tree").on("click",".toggleList",function(){$(this).toggleClass("open");$(this).parent(".parentNode").siblings(".childNodes").slideToggle()});$(".tree").on("click",".toggleListText",function(){$(this).siblings(".toggleList").toggleClass("open");$(this).parent(".parentNode").siblings(".childNodes").slideToggle()});$(".dxgvTable_GridDefaultTheme tr:first-child").show()})